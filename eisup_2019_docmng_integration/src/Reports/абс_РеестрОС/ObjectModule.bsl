
Процедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	
	_Параметры = КомпоновщикНастроек.ПолучитьНастройки(); 
        
	_КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;
	_МакетКомпоновки = _КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, _Параметры, ДанныеРасшифровки);  
	
	_ПроцесорКомпоновки = Новый ПроцессорКомпоновкиДанных;
	_ПроцесорКомпоновки.Инициализировать(_МакетКомпоновки, , ДанныеРасшифровки);
	
	ДокументРезультат.Очистить();
	
	_ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;
	_ПроцессорВывода.УстановитьДокумент(ДокументРезультат);
	_ПроцессорВывода.Вывести(_ПроцесорКомпоновки);
	
	ОбработатьЗаголовкиОтчета(ДокументРезультат); 
	
КонецПроцедуры


Процедура ОбработатьЗаголовкиОтчета(ТабДок)
	
	Для i = 2 По ТабДок.ФиксацияСверху Цикл
		Для j = 1 По ТабДок.ШиринаТаблицы Цикл
			
			ТекстЗначение = ТабДок.Область(i,j).Текст;
			ТекстОС 	  = ТабДок.Область(i-1,j).Текст;
			
			Если ТекстЗначение = "Значение" И (НЕ ПустаяСтрока(ТекстОС)) Тогда 
				ОбъединитьОбласть(ТабДок, i,j,i-1,j);
			КонецЕсли;
			
			Если ТекстЗначение = ТекстОС Тогда 
				ОбъединитьОбласть(ТабДок, i,j,i-1,j);
			КонецЕсли;
			
		КонецЦикла;
	КонецЦикла;                                      
		
КонецПроцедуры

Процедура ОбъединитьОбласть(ТабДок, НомерПервойСтроки, НомерПервойКолонки, НомерПоследнейСтроки, НомерПоследнейКолонки)
	
	ТекстЯчейки = ТабДок.Область(НомерПоследнейСтроки, НомерПервойКолонки).Текст;
	
	ОбъединяемаяОблать = ТабДок.Область(НомерПервойСтроки, НомерПервойКолонки, НомерПоследнейСтроки, НомерПоследнейКолонки);
	ОбъединяемаяОблать.Объединить();
	ОбъединяемаяОблать.ГоризонтальноеПоложение = ГоризонтальноеПоложение.Центр;
	ОбъединяемаяОблать.ВертикальноеПоложение = ВертикальноеПоложение.Центр;
	ОбъединяемаяОблать.Текст = ТекстЯчейки;
	
КонецПроцедуры
