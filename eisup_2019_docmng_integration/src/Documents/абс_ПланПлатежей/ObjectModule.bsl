Процедура ЗаполнитьПланПлатежей() Экспорт
	
	ГруппировкиПП.Очистить();
	
	СтрокиПП.Очистить();
	
	ЗапросГруппировки = Новый Запрос;
	
	ЗапросГруппировки.Текст =
	"ВЫБРАТЬ
	|	абс_ГруппировкиПланаПлатежей.Ссылка,
	|	абс_ГруппировкиПланаПлатежей.НаименованиеГруппировки,
	|	абс_ГруппировкиПланаПлатежей.ПорядокВПланеПлатежей КАК ПорядокВПланеПлатежей,
	|	абс_ГруппировкиПланаПлатежей.ТекстЗапроса
	|ИЗ
	|	Справочник.абс_ГруппировкиПланаПлатежей КАК абс_ГруппировкиПланаПлатежей
	|ГДЕ
	|	(НЕ абс_ГруппировкиПланаПлатежей.ПометкаУдаления)
	|
	|УПОРЯДОЧИТЬ ПО
	|	ПорядокВПланеПлатежей";
	
	ВыборкаГруппировки = ЗапросГруппировки.Выполнить().Выбрать();
	
	ВыведенныеСтроки = Новый ТаблицаЗначений;
	ВыведенныеСтроки.Колонки.Добавить("НомерСтроки");
	ВыведенныеСтроки.Колонки.Добавить("Документ");
	
	Пока ВыборкаГруппировки.Следующий() Цикл
		
		ЗапросСтрокиПП = Новый Запрос(ВыборкаГруппировки.ТекстЗапроса);
		
		ЗапросСтрокиПП.УстановитьПараметр("НомерНедели", НомерНедели);
		
		Для Каждого СтрокаПараметры Из ВыборкаГруппировки.Ссылка.ПараметрыЗапроса Цикл
			
			ЗапросСтрокиПП.УстановитьПараметр(СтрокаПараметры.НазваниеПараметра, СтрокаПараметры.Параметр);
		
		КонецЦикла;
		
		ГруппаПП = ГруппировкиПП.Добавить();
		ГруппаПП.ГруппаПП = ВыборкаГруппировки.Ссылка;
		
		ВыборкаСтрокиПП = ЗапросСтрокиПП.Выполнить().Выбрать();
		
		Пока ВыборкаСтрокиПП.Следующий() Цикл
			
			НайденныеСтроки = ВыведенныеСтроки.НайтиСтроки(Новый Структура("НомерСтроки, Документ", ВыборкаСтрокиПП.НомерСтрокиПлатежа, ВыборкаСтрокиПП.Документ));
			
			Если НайденныеСтроки.Количество() Тогда 
				Сообщить("Строка №" + ВыборкаСтрокиПП.НомерСтроки + " из документа " + ВыборкаСтрокиПП.Документ + " уже выводилась!");
			Иначе
				ЗаполнитьЗначенияСвойств(ВыведенныеСтроки.Добавить(), ВыборкаСтрокиПП);
			КонецЕсли;
			
			СтрокаПП = СтрокиПП.Добавить();
			
			СтрокаПП.ГруппаПП = ВыборкаГруппировки.Ссылка;
			
			ЗаполнитьЗначенияСвойств(СтрокаПП, ВыборкаСтрокиПП);
			
			СтрокаПП.СуммаСчета = ?(ЗначениеЗаполнено(ВыборкаСтрокиПП.Счет),ВыборкаСтрокиПП.Счет.СуммаПлатежа,0);
			
		КонецЦикла;			
	КонецЦикла;
		
КонецПроцедуры

Функция ПечатьПланаПлатежейПоДокументу()
	
	ТабДокумент = Новый ТабличныйДокумент;
	Макет = ПолучитьМакет("ПланПлатежей");
	
	ОбластьШапка = Макет.ПолучитьОбласть("Шапка");
	ОбластьЗаголовокРазмер10 = Макет.ПолучитьОбласть("ЗаголовокРазмер10");
	ОбластьЗаголовокРазмер11 = Макет.ПолучитьОбласть("ЗаголовокРазмер11");
	ОбластьГруппаПоступления = Макет.ПолучитьОбласть("ГруппаПоступления");
	ОбластьСтрокаПоКонтрагенту = Макет.ПолучитьОбласть("СтрокаПоКонтрагенту");
	ОбластьИтогиПоКонтрагенту1 = Макет.ПолучитьОбласть("ИтогиПоКонтрагенту1");
	ОбластьИтогиПоКонтрагенту2 = Макет.ПолучитьОбласть("ИтогиПоКонтрагенту2");
	ОбластьИтогиПоКонтрагенту3 = Макет.ПолучитьОбласть("ИтогиПоКонтрагенту3");
	ОбластьИтогиПоКонтрагенту4 = Макет.ПолучитьОбласть("ИтогиПоКонтрагенту4");
	ОбластьИтогиПоВиду = Макет.ПолучитьОбласть("ИтогиПоВиду");
	ОбластьИтогиПоВидуДеятельности = Макет.ПолучитьОбласть("ИтогиПоВидуДеятельности");
	ОбластьГруппаФинансоваяДеятельность = Макет.ПолучитьОбласть("ГруппаФинансоваяДеятельность");
	ОбластьПодвал = Макет.ПолучитьОбласть("Подвал");
	ОбластьШапкаНераспределенные = Макет.ПолучитьОбласть("ШапкаНераспределенные");
	ОбластьСтрокаНераспределенные = Макет.ПолучитьОбласть("СтрокаНераспределенные");
	
	
	ВалютаДоллар = Справочники.Валюты.НайтиПоКоду("840");
	ВалютаЕвро = Справочники.Валюты.НайтиПоКоду("978");
	СписокВалют = Новый СписокЗначений;
	СписокВалют.Добавить(ВалютаДоллар);
	СписокВалют.Добавить(ВалютаЕвро);
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	абс_ПлановыйКурсы.Валюта,
	|	абс_ПлановыйКурсы.ПлановыйКурс
	|ИЗ
	|	РегистрСведений.абс_ПлановыйКурсы КАК абс_ПлановыйКурсы
	|ГДЕ
	|	абс_ПлановыйКурсы.НомерНедели = &НомерНедели
	|	И абс_ПлановыйКурсы.Валюта В(&Валюты)";
	
	Запрос.УстановитьПараметр("НомерНедели", НомерНедели);
	Запрос.УстановитьПараметр("Валюты", СписокВалют);
	Выборка = Запрос.Выполнить().Выбрать();
	
	Пока Выборка.Следующий() Цикл
		Если Выборка.Валюта = ВалютаДоллар Тогда
			ОбластьШапка.Параметры.КурсДоллар = Выборка.ПлановыйКурс;
		ИначеЕсли Выборка.Валюта = ВалютаЕвро Тогда
			ОбластьШапка.Параметры.КурсЕвро = Выборка.ПлановыйКурс;
		КонецЕсли;
	КонецЦикла;
	
	ОбластьШапка.Параметры.НомерНедели = НомерНедели-1;
	ОбластьШапка.Параметры.Период = Формат(ДатаНачала,  "ДФ=MM.dd") + "/" + Формат(ДатаОкончания, "ДФ=MM.dd"); 
	
	ОбластьШапка.Параметры.Заполнить(ПолучитьСтруктуруЗаголовковШапки());
	
	ТабДокумент.Вывести(ОбластьШапка);
	
	ОбластьЗаголовокРазмер10.Параметры.Заголовок = "ОПЕРАЦИОННАЯ ДЕЯТЕЛЬНОСТЬ.";
	ТабДокумент.Вывести(ОбластьЗаголовокРазмер10);
	
	ТабДокумент.Вывести(ОбластьГруппаПоступления);
	
	ОбластьЗаголовокРазмер11.Параметры.Заголовок = "Расходы.";
	ТабДокумент.Вывести(ОбластьЗаголовокРазмер11);	
	
	Для Каждого СтрокаГруппаПП Из ГруппировкиПП Цикл
		
		ТекСтрокиПП = СтрокиПП.НайтиСтроки(Новый Структура("ГруппаПП", СтрокаГруппаПП.ГруппаПП));
		
		ОбластьЗаголовокРазмер10.Параметры.Заголовок = СтрокаГруппаПП.ГруппаПП.НаименованиеГруппировки;
				
		ТабДокумент.Вывести(ОбластьЗаголовокРазмер10);
		
		ТабДокумент.НачатьГруппуСтрок(СтрокаГруппаПП.ГруппаПП.НаименованиеГруппировки);	
		
		ИтогоПоГруппе = 0;
		
		СтруктураИтогов = ПолучитьСтруктуруИтогов();
		
		Для Каждого СтрокаПП из ТекСтрокиПП Цикл
			
			ЗаполнитьЗначенияСвойств(ОбластьСтрокаПоКонтрагенту.Параметры, СтрокаПП);
			ТабДокумент.Вывести(ОбластьСтрокаПоКонтрагенту);
			
			ИтогоПоГруппе = ИтогоПоГруппе + СтрокаПП.Сумма;
			
			Для Каждого КлючИтога Из СтруктураИтогов Цикл
				
				СтруктураИтогов[КлючИтога.Ключ] = СтруктураИтогов[КлючИтога.Ключ] + СтрокаПП[КлючИтога.Ключ];
				
			КонецЦикла;
			
		КонецЦикла;
		
		ТабДокумент.ЗакончитьГруппуСтрок();
		
		ОбластьИтогиПоВиду.Параметры.Сумма = ИтогоПоГруппе;
		
		ОбластьИтогиПоВиду.Параметры.Заполнить(СтруктураИтогов);
		
		//ИтогиРасходыОперационнаяДеятельность = ИтогиРасходыОперационнаяДеятельность + ВыборкаОбщая.Сумма; 
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);		
		
	КонецЦикла;
	
	Возврат ТабДокумент;
	
КонецФункции

Функция ПечатьПланаПлатежей()
	
	ТабДокумент = Новый ТабличныйДокумент;
	Макет = ПолучитьМакет("ПланПлатежей");
	
	ОбластьШапка = Макет.ПолучитьОбласть("Шапка");
	ОбластьЗаголовокРазмер10 = Макет.ПолучитьОбласть("ЗаголовокРазмер10");
	ОбластьЗаголовокРазмер11 = Макет.ПолучитьОбласть("ЗаголовокРазмер11");
	ОбластьГруппаПоступления = Макет.ПолучитьОбласть("ГруппаПоступления");
	ОбластьСтрокаПоКонтрагенту = Макет.ПолучитьОбласть("СтрокаПоКонтрагенту");
	ОбластьИтогиПоКонтрагенту1 = Макет.ПолучитьОбласть("ИтогиПоКонтрагенту1");
	ОбластьИтогиПоКонтрагенту2 = Макет.ПолучитьОбласть("ИтогиПоКонтрагенту2");
	ОбластьИтогиПоКонтрагенту3 = Макет.ПолучитьОбласть("ИтогиПоКонтрагенту3");
	ОбластьИтогиПоКонтрагенту4 = Макет.ПолучитьОбласть("ИтогиПоКонтрагенту4");
	ОбластьИтогиПоВиду = Макет.ПолучитьОбласть("ИтогиПоВиду");
	ОбластьИтогиПоВидуДеятельности = Макет.ПолучитьОбласть("ИтогиПоВидуДеятельности");
	ОбластьГруппаФинансоваяДеятельность = Макет.ПолучитьОбласть("ГруппаФинансоваяДеятельность");
	ОбластьПодвал = Макет.ПолучитьОбласть("Подвал");
	ОбластьШапкаНераспределенные = Макет.ПолучитьОбласть("ШапкаНераспределенные");
	ОбластьСтрокаНераспределенные = Макет.ПолучитьОбласть("СтрокаНераспределенные");
	
	ВалютаДоллар = Справочники.Валюты.НайтиПоКоду("840");
	ВалютаЕвро = Справочники.Валюты.НайтиПоКоду("978");
	СписокВалют = Новый СписокЗначений;
	СписокВалют.Добавить(ВалютаДоллар);
	СписокВалют.Добавить(ВалютаЕвро);
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	абс_ПлановыйКурсы.Валюта,
	|	абс_ПлановыйКурсы.ПлановыйКурс
	|ИЗ
	|	РегистрСведений.абс_ПлановыйКурсы КАК абс_ПлановыйКурсы
	|ГДЕ
	|	абс_ПлановыйКурсы.НомерНедели = &НомерНедели
	|	И абс_ПлановыйКурсы.Валюта В(&Валюты)";
	
	Запрос.УстановитьПараметр("НомерНедели", НомерНедели);
	Запрос.УстановитьПараметр("Валюты", СписокВалют);
	Выборка = Запрос.Выполнить().Выбрать();
	
	Пока Выборка.Следующий() Цикл
		Если Выборка.Валюта = ВалютаДоллар Тогда
			ОбластьШапка.Параметры.КурсДоллар = Выборка.ПлановыйКурс;
		ИначеЕсли Выборка.Валюта = ВалютаЕвро Тогда
			ОбластьШапка.Параметры.КурсЕвро = Выборка.ПлановыйКурс;
		КонецЕсли;
	КонецЦикла;
	
	ОбластьШапка.Параметры.НомерНедели = НомерНедели-1;
	ОбластьШапка.Параметры.Период = Формат(ДатаНачала,  "ДФ=MM.dd") + "/" + Формат(ДатаОкончания, "ДФ=MM.dd"); 
	ТабДокумент.Вывести(ОбластьШапка);
	
	ОбластьЗаголовокРазмер10.Параметры.Заголовок = "ОПЕРАЦИОННАЯ ДЕЯТЕЛЬНОСТЬ.";
	ТабДокумент.Вывести(ОбластьЗаголовокРазмер10);
	
	ТабДокумент.Вывести(ОбластьГруппаПоступления);
	
	ОбластьЗаголовокРазмер11.Параметры.Заголовок = "Расходы.";
	ТабДокумент.Вывести(ОбластьЗаголовокРазмер11);
	
	ИтогиРасходыОперационнаяДеятельность = 0;
	ИтогиРасходыИнвестиционнаяДеятельность = 0;

	ЦФУ_Строительство = Справочники.абс_ЦФУ.НайтиПоКоду("ЦФУ4");
	ЦФУ_Связь = Справочники.абс_ЦФУ.НайтиПоКоду("ЦФУ123");
	ЦФУ_Эксплуатация = Справочники.абс_ЦФУ.НайтиПоКоду("ЦФУ5");
	
	БюджетныеСтатьиСтроительство = Справочники.СтатьиОборотовПоБюджетам.НайтиПоКоду("ПРСт");
	БюджетныеСтатьиЭксплуатация = Справочники.СтатьиОборотовПоБюджетам.НайтиПоКоду("ПРЭ");
	БюджетныеСтатьиСвязь = Справочники.СтатьиОборотовПоБюджетам.НайтиПоКоду("ПРС");
	БюджетныеСтатьиСИ = Справочники.СтатьиОборотовПоБюджетам.НайтиПоКоду("ПРСи");
	БюджетныеСтатьиКапвложения = Справочники.СтатьиОборотовПоБюджетам.НайтиПоКоду("КВ");
	
	БюджетныеСтатьиПРСт010203 = Новый СписокЗначений;
	БюджетныеСтатьиПРСт010203.Добавить(Справочники.СтатьиОборотовПоБюджетам.НайтиПоКоду("ПРСТ01"));
	БюджетныеСтатьиПРСт010203.Добавить(Справочники.СтатьиОборотовПоБюджетам.НайтиПоКоду("ПРСТ02"));
	БюджетныеСтатьиПРСт010203.Добавить(Справочники.СтатьиОборотовПоБюджетам.НайтиПоКоду("ПРСТ03"));
	
	БюджетныеСтатьиПРСЭ0101_0102 = Новый СписокЗначений;
	БюджетныеСтатьиПРСЭ0101_0102.Добавить(Справочники.СтатьиОборотовПоБюджетам.НайтиПоКоду("ПРСЭ0101"));
	БюджетныеСтатьиПРСЭ0101_0102.Добавить(Справочники.СтатьиОборотовПоБюджетам.НайтиПоКоду("ПРСЭ0102"));
	
	БюджетныеСтатьиКосвенныеПрочие = Новый СписокЗначений;
	БюджетныеСтатьиКосвенныеПрочие.Добавить(Справочники.СтатьиОборотовПоБюджетам.НайтиПоКоду("КОС"));
	БюджетныеСтатьиКосвенныеПрочие.Добавить(Справочники.СтатьиОборотовПоБюджетам.НайтиПоКоду("ПрР"));

	ВыведенныеСтроки = Новый ТаблицаЗначений;
	ВыведенныеСтроки.Колонки.Добавить("НомерСтроки");
	ВыведенныеСтроки.Колонки.Добавить("Документ");
	
	ОбластьЗаголовокРазмер10.Параметры.Заголовок = "Прочие строительные программы. Х-ТТК.";
	ТабДокумент.Вывести(ОбластьЗаголовокРазмер10);
	
	Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ
	|	абс_ПлатежСоставПлатежей.Ссылка КАК Документ,
	|	абс_ПлатежСоставПлатежей.НомерСтроки,
	|	абс_ПлатежСоставПлатежей.Контрагент КАК Контрагент,
	|	ВЫБОР
	|		КОГДА абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП = """"
	|			ТОГДА абс_ПлатежСоставПлатежей.Контрагент.Наименование
	|		ИНАЧЕ абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП
	|	КОНЕЦ КАК КонтрагентНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО.абс_НаименованиеПП КАК ЦФОНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья,
	|	абс_ПлатежСоставПлатежей.СуммаПлатежа КАК Сумма,
	|	абс_ПлатежСоставПлатежей.ОснованиеПлатежа,
	|	абс_ПлатежСоставПлатежей.НазначениеПлатежа,
	|	абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала КАК НомерНедели,
	|	абс_ПлатежСоставПлатежей.Счет.Комментарий КАК Комментарий
	|	,абс_МеппингСтатейДДСиСтатейБюджета.СтатьяДДСНаименование КАК БюджетнаяСтатьяСтар
	|ИЗ
	|	Документ.абс_Платеж.СоставПлатежей КАК абс_ПлатежСоставПлатежей
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.абс_МеппингСтатейДДСиСтатейБюджета КАК абс_МеппингСтатейДДСиСтатейБюджета
	|		ПО абс_ПлатежСоставПлатежей.Счет.БюджетнаяСтатья = абс_МеппингСтатейДДСиСтатейБюджета.БюджетнаяСтатья

	|ГДЕ
	|	(НЕ абс_ПлатежСоставПлатежей.Ссылка.ПометкаУдаления)
	|	И (НЕ абс_ПлатежСоставПлатежей.Ссылка.СтатусПлана = ЗНАЧЕНИЕ(Перечисление.абс_СтатусыПланаПлатежей.Разутвержден))
	|	И абс_ПлатежСоставПлатежей.Счет.Контрагент.абс_ТипыКонтрагентов В ИЕРАРХИИ (ЗНАЧЕНИЕ(Справочник.абс_ТипыКонтрагентов.ХТТК))
	|	И абс_ПлатежСоставПлатежей.Ссылка.ЦФУ = &ЦФУ
	|	И абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья В ИЕРАРХИИ(&ГруппаСтатейОборотов)
	|	И (НЕ абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья В (&БюджетныеСтатьиПРСТ010203))
	|	И абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала = &НомерНедели
	|
	|УПОРЯДОЧИТЬ ПО
	|	КонтрагентНаименованиеПП,
	|	Сумма УБЫВ
	|ИТОГИ
	|	СУММА(Сумма)
	|ПО
	|	ОБЩИЕ,
	|	Контрагент";
	Запрос.УстановитьПараметр("НомерНедели", НомерНедели);
	Запрос.УстановитьПараметр("ЦФУ", ЦФУ_Строительство);
	Запрос.УстановитьПараметр("ГруппаСтатейОборотов", БюджетныеСтатьиСтроительство);
	Запрос.УстановитьПараметр("БюджетныеСтатьиПРСт010203", БюджетныеСтатьиПРСт010203);
	
	ВыборкаОбщая = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	
	//1.
	
	Если ВыборкаОбщая.Следующий() Тогда
		
		ВыборкаПоКонтрагенту = ВыборкаОбщая.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		Пока ВыборкаПоКонтрагенту.Следующий() Цикл
			
			ВыборкаПоСтрокам = ВыборкаПоКонтрагенту.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
			
			Пока ВыборкаПоСтрокам.Следующий() Цикл
				
				ЗаполнитьЗначенияСвойств(ОбластьСтрокаПоКонтрагенту.Параметры, ВыборкаПоСтрокам);
				ТабДокумент.Вывести(ОбластьСтрокаПоКонтрагенту);
				НайденныеСтроки = ВыведенныеСтроки.НайтиСтроки(Новый Структура("НомерСтроки, Документ", ВыборкаПоСтрокам.НомерСтроки, ВыборкаПоСтрокам.Документ));
				
				Если НайденныеСтроки.Количество() Тогда 
					Сообщить("Строка №" + ВыборкаПоСтрокам.НомерСтроки + " из документа " + ВыборкаПоСтрокам.Документ + " уже выводилась!");
				Иначе
					ЗаполнитьЗначенияСвойств(ВыведенныеСтроки.Добавить(), ВыборкаПоСтрокам);
				КонецЕсли;
				
			КонецЦикла;
			
			ЗаполнитьЗначенияСвойств(ОбластьИтогиПоКонтрагенту1.Параметры, ВыборкаПоКонтрагенту);
			ТабДокумент.Вывести(ОбластьИтогиПоКонтрагенту1);
			
		КонецЦикла;
		
		ОбластьИтогиПоВиду.Параметры.Сумма = ВыборкаОбщая.Сумма;
		ИтогиРасходыОперационнаяДеятельность = ИтогиРасходыОперационнаяДеятельность + ВыборкаОбщая.Сумма; 
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	Иначе
		
		ОбластьИтогиПоВиду.Параметры.Сумма = 0;
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	КонецЕсли;
	
	ОбластьЗаголовокРазмер10.Параметры.Заголовок = "Прочие строительные программы. Прочие подрядчики.";
	ТабДокумент.Вывести(ОбластьЗаголовокРазмер10);
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	абс_ПлатежСоставПлатежей.Ссылка КАК Документ,
	|	абс_ПлатежСоставПлатежей.НомерСтроки,
	|	абс_ПлатежСоставПлатежей.Контрагент КАК Контрагент,
	|	ВЫБОР
	|		КОГДА абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП = """"
	|			ТОГДА абс_ПлатежСоставПлатежей.Контрагент.Наименование
	|		ИНАЧЕ абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП
	|	КОНЕЦ КАК КонтрагентНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО.абс_НаименованиеПП КАК ЦФОНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья,
	|	абс_ПлатежСоставПлатежей.СуммаПлатежа КАК Сумма,
	|	абс_ПлатежСоставПлатежей.ОснованиеПлатежа,
	|	абс_ПлатежСоставПлатежей.НазначениеПлатежа,
	|	абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала КАК НомерНедели,
	|	абс_ПлатежСоставПлатежей.Счет.Комментарий КАК Комментарий
	|	,абс_МеппингСтатейДДСиСтатейБюджета.СтатьяДДСНаименование КАК БюджетнаяСтатьяСтар
	|ИЗ
	|	Документ.абс_Платеж.СоставПлатежей КАК абс_ПлатежСоставПлатежей
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.абс_МеппингСтатейДДСиСтатейБюджета КАК абс_МеппингСтатейДДСиСтатейБюджета
	|		ПО абс_ПлатежСоставПлатежей.Счет.БюджетнаяСтатья = абс_МеппингСтатейДДСиСтатейБюджета.БюджетнаяСтатья

	|ГДЕ
	|	(НЕ абс_ПлатежСоставПлатежей.Ссылка.ПометкаУдаления)
	|	И (НЕ абс_ПлатежСоставПлатежей.Ссылка.СтатусПлана = ЗНАЧЕНИЕ(Перечисление.абс_СтатусыПланаПлатежей.Разутвержден))
	|	И (НЕ абс_ПлатежСоставПлатежей.Счет.Контрагент.абс_ТипыКонтрагентов В ИЕРАРХИИ (ЗНАЧЕНИЕ(Справочник.абс_ТипыКонтрагентов.ХТТК)))
	|	И абс_ПлатежСоставПлатежей.Ссылка.ЦФУ = &ЦФУ
	|	И абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья В ИЕРАРХИИ(&ГруппаСтатейОборотов)
	|	И (НЕ абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья В (&БюджетныеСтатьиПРСТ010203))
	|	И абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала = &НомерНедели
	|
	|УПОРЯДОЧИТЬ ПО
	|	КонтрагентНаименованиеПП,
	|	Сумма УБЫВ
	|ИТОГИ
	|	СУММА(Сумма)
	|ПО
	|	ОБЩИЕ";
	Запрос.УстановитьПараметр("ЦФУ", ЦФУ_Строительство);
	Запрос.УстановитьПараметр("ГруппаСтатейОборотов", БюджетныеСтатьиСтроительство);
	
	ВыборкаОбщая = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	
	// 2.
	
	Если ВыборкаОбщая.Следующий() Тогда
		
		ВыборкаПоСтрокам = ВыборкаОбщая.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		Пока ВыборкаПоСтрокам.Следующий() Цикл
			
			ЗаполнитьЗначенияСвойств(ОбластьСтрокаПоКонтрагенту.Параметры, ВыборкаПоСтрокам);
			ТабДокумент.Вывести(ОбластьСтрокаПоКонтрагенту);
			НайденныеСтроки = ВыведенныеСтроки.НайтиСтроки(Новый Структура("НомерСтроки, Документ", ВыборкаПоСтрокам.НомерСтроки, ВыборкаПоСтрокам.Документ));
			
			Если НайденныеСтроки.Количество() Тогда 
				Сообщить("Строка №" + ВыборкаПоСтрокам.НомерСтроки + " из документа " + ВыборкаПоСтрокам.Документ + " уже выводилась!");
			Иначе
				ЗаполнитьЗначенияСвойств(ВыведенныеСтроки.Добавить(), ВыборкаПоСтрокам);
			КонецЕсли;
			
		КонецЦикла;
		
		ОбластьИтогиПоВиду.Параметры.Сумма = ВыборкаОбщая.Сумма;
		ИтогиРасходыОперационнаяДеятельность = ИтогиРасходыОперационнаяДеятельность + ВыборкаОбщая.Сумма; 
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	Иначе
		
		ОбластьИтогиПоВиду.Параметры.Сумма = 0;
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	КонецЕсли;

	ОбластьЗаголовокРазмер10.Параметры.Заголовок = "Программы ДКСС.";
	ТабДокумент.Вывести(ОбластьЗаголовокРазмер10);
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	абс_ПлатежСоставПлатежей.Ссылка КАК Документ,
	|	абс_ПлатежСоставПлатежей.НомерСтроки,
	|	абс_ПлатежСоставПлатежей.Контрагент КАК Контрагент,
	|	ВЫБОР
	|		КОГДА абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП = """"
	|			ТОГДА абс_ПлатежСоставПлатежей.Контрагент.Наименование
	|		ИНАЧЕ абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП
	|	КОНЕЦ КАК КонтрагентНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО.абс_НаименованиеПП КАК ЦФОНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья,
	|	абс_ПлатежСоставПлатежей.СуммаПлатежа КАК Сумма,
	|	абс_ПлатежСоставПлатежей.ОснованиеПлатежа,
	|	абс_ПлатежСоставПлатежей.НазначениеПлатежа,
	|	абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала КАК НомерНедели,
	|	абс_ПлатежСоставПлатежей.Счет.Комментарий КАК Комментарий
	|	,абс_МеппингСтатейДДСиСтатейБюджета.СтатьяДДСНаименование КАК БюджетнаяСтатьяСтар
	|ИЗ
	|	Документ.абс_Платеж.СоставПлатежей КАК абс_ПлатежСоставПлатежей
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.абс_МеппингСтатейДДСиСтатейБюджета КАК абс_МеппингСтатейДДСиСтатейБюджета
	|		ПО абс_ПлатежСоставПлатежей.Счет.БюджетнаяСтатья = абс_МеппингСтатейДДСиСтатейБюджета.БюджетнаяСтатья

	|ГДЕ
	|	(НЕ абс_ПлатежСоставПлатежей.Ссылка.ПометкаУдаления)
	|	И (НЕ абс_ПлатежСоставПлатежей.Ссылка.СтатусПлана = ЗНАЧЕНИЕ(Перечисление.абс_СтатусыПланаПлатежей.Разутвержден))
	|	И абс_ПлатежСоставПлатежей.Ссылка.ЦФУ = &ЦФУ
	|	И абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья В (&БюджетныеСтатьиПРСТ010203)
	|	И абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала = &НомерНедели
	|
	|УПОРЯДОЧИТЬ ПО
	|	КонтрагентНаименованиеПП,
	|	Сумма УБЫВ
	|ИТОГИ
	|	СУММА(Сумма)
	|ПО
	|	ОБЩИЕ";
	Запрос.УстановитьПараметр("ЦФУ", ЦФУ_Строительство);
	
	ВыборкаОбщая = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	
	// 3. 
	
	Если ВыборкаОбщая.Следующий() Тогда
		
		ВыборкаПоСтрокам = ВыборкаОбщая.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		Пока ВыборкаПоСтрокам.Следующий() Цикл
			
			ЗаполнитьЗначенияСвойств(ОбластьСтрокаПоКонтрагенту.Параметры, ВыборкаПоСтрокам);
			ТабДокумент.Вывести(ОбластьСтрокаПоКонтрагенту);
			НайденныеСтроки = ВыведенныеСтроки.НайтиСтроки(Новый Структура("НомерСтроки, Документ", ВыборкаПоСтрокам.НомерСтроки, ВыборкаПоСтрокам.Документ));
			
			Если НайденныеСтроки.Количество() Тогда 
				Сообщить("Строка №" + ВыборкаПоСтрокам.НомерСтроки + " из документа " + ВыборкаПоСтрокам.Документ + " уже выводилась!");
			Иначе
				ЗаполнитьЗначенияСвойств(ВыведенныеСтроки.Добавить(), ВыборкаПоСтрокам);
			КонецЕсли;
			
		КонецЦикла;
		
		ОбластьИтогиПоВиду.Параметры.Сумма = ВыборкаОбщая.Сумма;
		ИтогиРасходыОперационнаяДеятельность = ИтогиРасходыОперационнаяДеятельность + ВыборкаОбщая.Сумма; 
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	Иначе
		
		ОбластьИтогиПоВиду.Параметры.Сумма = 0;
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	КонецЕсли;

	ОбластьЗаголовокРазмер10.Параметры.Заголовок = "Х-ТТК. Эксплуатация.";
	ТабДокумент.Вывести(ОбластьЗаголовокРазмер10);
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	абс_ПлатежСоставПлатежей.Ссылка КАК Документ,
	|	абс_ПлатежСоставПлатежей.НомерСтроки,
	|	абс_ПлатежСоставПлатежей.Контрагент КАК Контрагент,
	|	ВЫБОР
	|		КОГДА абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП = """"
	|			ТОГДА абс_ПлатежСоставПлатежей.Контрагент.Наименование
	|		ИНАЧЕ абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП
	|	КОНЕЦ КАК КонтрагентНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО.абс_НаименованиеПП КАК ЦФОНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья,
	|	абс_ПлатежСоставПлатежей.СуммаПлатежа КАК Сумма,
	|	абс_ПлатежСоставПлатежей.ОснованиеПлатежа,
	|	абс_ПлатежСоставПлатежей.НазначениеПлатежа,
	|	абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала КАК НомерНедели,
	|	абс_ПлатежСоставПлатежей.Счет.Комментарий КАК Комментарий
	|	,абс_МеппингСтатейДДСиСтатейБюджета.СтатьяДДСНаименование КАК БюджетнаяСтатьяСтар
	|ИЗ
	|	Документ.абс_Платеж.СоставПлатежей КАК абс_ПлатежСоставПлатежей
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.абс_МеппингСтатейДДСиСтатейБюджета КАК абс_МеппингСтатейДДСиСтатейБюджета
	|		ПО абс_ПлатежСоставПлатежей.Счет.БюджетнаяСтатья = абс_МеппингСтатейДДСиСтатейБюджета.БюджетнаяСтатья

	|ГДЕ
	|	(НЕ абс_ПлатежСоставПлатежей.Ссылка.ПометкаУдаления)
	|	И (НЕ абс_ПлатежСоставПлатежей.Ссылка.СтатусПлана = ЗНАЧЕНИЕ(Перечисление.абс_СтатусыПланаПлатежей.Разутвержден))
	|	И абс_ПлатежСоставПлатежей.Счет.Контрагент.абс_ТипыКонтрагентов В ИЕРАРХИИ(Значение(Справочник.абс_ТипыКонтрагентов.ХТТК))
	|	И абс_ПлатежСоставПлатежей.Ссылка.ЦФУ = &ЦФУ
	|	И НЕ абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья В ИЕРАРХИИ(&БюджетныеСтатьиКапвложения)
	|	И НЕ абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья В ИЕРАРХИИ(&БюджетныеСтатьиКосвенныеПрочие)
	|	И абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала = &НомерНедели
	|
	|УПОРЯДОЧИТЬ ПО
	|	КонтрагентНаименованиеПП,
	|	Сумма УБЫВ
	|ИТОГИ
	|	СУММА(Сумма)
	|ПО
	|	ОБЩИЕ,
	|	Контрагент";
	Запрос.УстановитьПараметр("ЦФУ", ЦФУ_Эксплуатация);
	Запрос.УстановитьПараметр("ГруппаСтатейОборотов", БюджетныеСтатьиЭксплуатация);
	Запрос.УстановитьПараметр("БюджетныеСтатьиКапвложения", БюджетныеСтатьиКапвложения);
	Запрос.УстановитьПараметр("БюджетныеСтатьиКосвенныеПрочие", БюджетныеСтатьиКосвенныеПрочие);
	
	ВыборкаОбщая = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	
	// 4.
	
	Если ВыборкаОбщая.Следующий() Тогда
		
		ВыборкаПоКонтрагенту = ВыборкаОбщая.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		Пока ВыборкаПоКонтрагенту.Следующий() Цикл
			
			ВыборкаПоСтрокам = ВыборкаПоКонтрагенту.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
			
			Пока ВыборкаПоСтрокам.Следующий() Цикл
				
				ЗаполнитьЗначенияСвойств(ОбластьСтрокаПоКонтрагенту.Параметры, ВыборкаПоСтрокам);
				ТабДокумент.Вывести(ОбластьСтрокаПоКонтрагенту);
				НайденныеСтроки = ВыведенныеСтроки.НайтиСтроки(Новый Структура("НомерСтроки, Документ", ВыборкаПоСтрокам.НомерСтроки, ВыборкаПоСтрокам.Документ));
				
				Если НайденныеСтроки.Количество() Тогда 
					Сообщить("Строка №" + ВыборкаПоСтрокам.НомерСтроки + " из документа " + ВыборкаПоСтрокам.Документ + " уже выводилась!");
				Иначе
					ЗаполнитьЗначенияСвойств(ВыведенныеСтроки.Добавить(), ВыборкаПоСтрокам);
				КонецЕсли;
				
			КонецЦикла;
			
			ЗаполнитьЗначенияСвойств(ОбластьИтогиПоКонтрагенту2.Параметры, ВыборкаПоКонтрагенту);
			ТабДокумент.Вывести(ОбластьИтогиПоКонтрагенту2);
			
		КонецЦикла;
		
		ОбластьИтогиПоВиду.Параметры.Сумма = ВыборкаОбщая.Сумма;
		ИтогиРасходыОперационнаяДеятельность = ИтогиРасходыОперационнаяДеятельность + ВыборкаОбщая.Сумма; 
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	Иначе
		
		ОбластьИтогиПоВиду.Параметры.Сумма = 0;
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	КонецЕсли;
	
	ОбластьЗаголовокРазмер10.Параметры.Заголовок = "Х-ТТК. Связь.";
	ТабДокумент.Вывести(ОбластьЗаголовокРазмер10);
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	абс_ПлатежСоставПлатежей.Ссылка КАК Документ,
	|	абс_ПлатежСоставПлатежей.НомерСтроки,
	|	абс_ПлатежСоставПлатежей.Контрагент КАК Контрагент,
	|	ВЫБОР
	|		КОГДА абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП = """"
	|			ТОГДА абс_ПлатежСоставПлатежей.Контрагент.Наименование
	|		ИНАЧЕ абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП
	|	КОНЕЦ КАК КонтрагентНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО.абс_НаименованиеПП КАК ЦФОНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья,
	|	абс_ПлатежСоставПлатежей.СуммаПлатежа КАК Сумма,
	|	абс_ПлатежСоставПлатежей.ОснованиеПлатежа,
	|	абс_ПлатежСоставПлатежей.НазначениеПлатежа,
	|	абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала КАК НомерНедели,
	|	абс_ПлатежСоставПлатежей.Счет.Комментарий КАК Комментарий
	|	,абс_МеппингСтатейДДСиСтатейБюджета.СтатьяДДСНаименование КАК БюджетнаяСтатьяСтар
	|ИЗ
	|	Документ.абс_Платеж.СоставПлатежей КАК абс_ПлатежСоставПлатежей
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.абс_МеппингСтатейДДСиСтатейБюджета КАК абс_МеппингСтатейДДСиСтатейБюджета
	|		ПО абс_ПлатежСоставПлатежей.Счет.БюджетнаяСтатья = абс_МеппингСтатейДДСиСтатейБюджета.БюджетнаяСтатья

	|ГДЕ
	|	(НЕ абс_ПлатежСоставПлатежей.Ссылка.ПометкаУдаления)
	|	И (НЕ абс_ПлатежСоставПлатежей.Ссылка.СтатусПлана = ЗНАЧЕНИЕ(Перечисление.абс_СтатусыПланаПлатежей.Разутвержден))
	|	И абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала = &НомерНедели
	|	И абс_ПлатежСоставПлатежей.Счет.Контрагент.абс_ТипыКонтрагентов В ИЕРАРХИИ (ЗНАЧЕНИЕ(Справочник.абс_ТипыКонтрагентов.ХТТК))
	|	И (абс_ПлатежСоставПлатежей.Ссылка.ЦФУ = &ЦФУ
	|				И (НЕ абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья В ИЕРАРХИИ (&БюджетныеСтатьиКапвложения))
	|				И (НЕ абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья В ИЕРАРХИИ (&БюджетныеСтатьиКосвенныеПрочие))
	|			ИЛИ ВЫБОР
	|				КОГДА абс_ПлатежСоставПлатежей.Ссылка.ЦФУ = &ЦФУ_Строительство
	|						И абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья В ИЕРАРХИИ (&БюджетныеСтатьиСтроительство)
	|						И (НЕ абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья В (&БюджетныеСтатьиПРСТ010203))
	|					ТОГДА ИСТИНА
	|				КОГДА (абс_ПлатежСоставПлатежей.Ссылка.ЦФУ = &ЦФУ_Эксплуатация ИЛИ абс_ПлатежСоставПлатежей.Ссылка.ЦФУ = &ЦФУ)
	|						И (НЕ абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья В ИЕРАРХИИ (&БюджетныеСтатьиКапвложения))
	|						И (НЕ абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья В ИЕРАРХИИ (&БюджетныеСтатьиКосвенныеПрочие))
	|					ТОГДА ИСТИНА
	|				КОГДА абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья В ИЕРАРХИИ (&БюджетныеСтатьиКапвложения)
	|					ТОГДА ИСТИНА
	|				ИНАЧЕ ЛОЖЬ
	|			КОНЕЦ = ЛОЖЬ)
	|
	|УПОРЯДОЧИТЬ ПО
	|	КонтрагентНаименованиеПП,
	|	Сумма УБЫВ
	|ИТОГИ
	|	СУММА(Сумма)
	|ПО
	|	ОБЩИЕ,
	|	Контрагент";
	Запрос.УстановитьПараметр("ЦФУ", ЦФУ_Связь);
	Запрос.УстановитьПараметр("ЦФУ_Строительство", ЦФУ_Строительство);
	Запрос.УстановитьПараметр("ЦФУ_Эксплуатация",  ЦФУ_Эксплуатация);
	Запрос.УстановитьПараметр("БюджетныеСтатьиСтроительство", БюджетныеСтатьиСтроительство);
	Запрос.УстановитьПараметр("ГруппаСтатейОборотов", БюджетныеСтатьиСвязь);
	
	ВыборкаОбщая = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	
	// 5. 
	
	Если ВыборкаОбщая.Следующий() Тогда
		
		ВыборкаПоКонтрагенту = ВыборкаОбщая.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		Пока ВыборкаПоКонтрагенту.Следующий() Цикл
			
			ВыборкаПоСтрокам = ВыборкаПоКонтрагенту.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
			
			Пока ВыборкаПоСтрокам.Следующий() Цикл
				
				ЗаполнитьЗначенияСвойств(ОбластьСтрокаПоКонтрагенту.Параметры, ВыборкаПоСтрокам);
				ТабДокумент.Вывести(ОбластьСтрокаПоКонтрагенту);
				НайденныеСтроки = ВыведенныеСтроки.НайтиСтроки(Новый Структура("НомерСтроки, Документ", ВыборкаПоСтрокам.НомерСтроки, ВыборкаПоСтрокам.Документ));
				
				Если НайденныеСтроки.Количество() Тогда 
					Сообщить("Строка №" + ВыборкаПоСтрокам.НомерСтроки + " из документа " + ВыборкаПоСтрокам.Документ + " уже выводилась!");
				Иначе
					ЗаполнитьЗначенияСвойств(ВыведенныеСтроки.Добавить(), ВыборкаПоСтрокам);
				КонецЕсли;
				
			КонецЦикла;
			
			ЗаполнитьЗначенияСвойств(ОбластьИтогиПоКонтрагенту3.Параметры, ВыборкаПоКонтрагенту);
			ТабДокумент.Вывести(ОбластьИтогиПоКонтрагенту3);
			
		КонецЦикла;
		
		ОбластьИтогиПоВиду.Параметры.Сумма = ВыборкаОбщая.Сумма;
		ИтогиРасходыОперационнаяДеятельность = ИтогиРасходыОперационнаяДеятельность + ВыборкаОбщая.Сумма; 
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	Иначе
		
		ОбластьИтогиПоВиду.Параметры.Сумма = 0;
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	КонецЕсли;
	
	ОбластьЗаголовокРазмер10.Параметры.Заголовок = "Операционные расходы. Связь.";
	ТабДокумент.Вывести(ОбластьЗаголовокРазмер10);
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	абс_ПлатежСоставПлатежей.Ссылка КАК Документ,
	|	абс_ПлатежСоставПлатежей.НомерСтроки,
	|	абс_ПлатежСоставПлатежей.Контрагент КАК Контрагент,
	|	ВЫБОР
	|		КОГДА абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП = """"
	|			ТОГДА абс_ПлатежСоставПлатежей.Контрагент.Наименование
	|		ИНАЧЕ абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП
	|	КОНЕЦ КАК КонтрагентНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО.абс_НаименованиеПП КАК ЦФОНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья,
	|	абс_ПлатежСоставПлатежей.СуммаПлатежа КАК Сумма,
	|	абс_ПлатежСоставПлатежей.ОснованиеПлатежа,
	|	абс_ПлатежСоставПлатежей.НазначениеПлатежа,
	|	абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала КАК НомерНедели,
	|	абс_ПлатежСоставПлатежей.Счет.Комментарий КАК Комментарий
	|	,абс_МеппингСтатейДДСиСтатейБюджета.СтатьяДДСНаименование КАК БюджетнаяСтатьяСтар
	|ИЗ
	|	Документ.абс_Платеж.СоставПлатежей КАК абс_ПлатежСоставПлатежей
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.абс_МеппингСтатейДДСиСтатейБюджета КАК абс_МеппингСтатейДДСиСтатейБюджета
	|		ПО абс_ПлатежСоставПлатежей.Счет.БюджетнаяСтатья = абс_МеппингСтатейДДСиСтатейБюджета.БюджетнаяСтатья

	|ГДЕ
	|	(НЕ абс_ПлатежСоставПлатежей.Ссылка.ПометкаУдаления)
	|	И абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала = &НомерНедели
	|	И (НЕ абс_ПлатежСоставПлатежей.Ссылка.СтатусПлана = ЗНАЧЕНИЕ(Перечисление.абс_СтатусыПланаПлатежей.Разутвержден))
	|	И абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья В ИЕРАРХИИ(&ГруппаСтатейОборотов)
	|	И (НЕ абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья В ИЕРАРХИИ (&БюджетныеСтатьиПРСЭ0101_0102))
	|	И (НЕ абс_ПлатежСоставПлатежей.Счет.Контрагент.абс_ТипыКонтрагентов В ИЕРАРХИИ (ЗНАЧЕНИЕ(Справочник.абс_ТипыКонтрагентов.ХТТК)))
	|
	|УПОРЯДОЧИТЬ ПО
	|	КонтрагентНаименованиеПП,
	|	Сумма УБЫВ
	|ИТОГИ
	|	СУММА(Сумма)
	|ПО
	|	ОБЩИЕ";
	Запрос.УстановитьПараметр("ЦФУ", ЦФУ_Связь);
	Запрос.УстановитьПараметр("ГруппаСтатейОборотов", БюджетныеСтатьиСвязь);
	Запрос.УстановитьПараметр("БюджетныеСтатьиПРСЭ0101_0102", БюджетныеСтатьиПРСЭ0101_0102);
	
	ВыборкаОбщая = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	
	// 6.
	
	Если ВыборкаОбщая.Следующий() Тогда
		
		ВыборкаПоСтрокам = ВыборкаОбщая.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		Пока ВыборкаПоСтрокам.Следующий() Цикл
			
			ЗаполнитьЗначенияСвойств(ОбластьСтрокаПоКонтрагенту.Параметры, ВыборкаПоСтрокам);
			ТабДокумент.Вывести(ОбластьСтрокаПоКонтрагенту);
			НайденныеСтроки = ВыведенныеСтроки.НайтиСтроки(Новый Структура("НомерСтроки, Документ", ВыборкаПоСтрокам.НомерСтроки, ВыборкаПоСтрокам.Документ));
			
			Если НайденныеСтроки.Количество() Тогда 
				Сообщить("Строка №" + ВыборкаПоСтрокам.НомерСтроки + " из документа " + ВыборкаПоСтрокам.Документ + " уже выводилась!");
			Иначе
				ЗаполнитьЗначенияСвойств(ВыведенныеСтроки.Добавить(), ВыборкаПоСтрокам);
			КонецЕсли;
			
		КонецЦикла;
		
		ОбластьИтогиПоВиду.Параметры.Сумма = ВыборкаОбщая.Сумма;
		ИтогиРасходыОперационнаяДеятельность = ИтогиРасходыОперационнаяДеятельность + ВыборкаОбщая.Сумма; 
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	Иначе
		
		ОбластьИтогиПоВиду.Параметры.Сумма = 0;
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	КонецЕсли;

	ОбластьЗаголовокРазмер10.Параметры.Заголовок = "Операционные расходы. Системная интеграция";
	ТабДокумент.Вывести(ОбластьЗаголовокРазмер10);
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	абс_ПлатежСоставПлатежей.Ссылка КАК Документ,
	|	абс_ПлатежСоставПлатежей.НомерСтроки,
	|	абс_ПлатежСоставПлатежей.Контрагент КАК Контрагент,
	|	ВЫБОР
	|		КОГДА абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП = """"
	|			ТОГДА абс_ПлатежСоставПлатежей.Контрагент.Наименование
	|		ИНАЧЕ абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП
	|	КОНЕЦ КАК КонтрагентНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО.абс_НаименованиеПП КАК ЦФОНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья,
	|	абс_ПлатежСоставПлатежей.СуммаПлатежа КАК Сумма,
	|	абс_ПлатежСоставПлатежей.ОснованиеПлатежа,
	|	абс_ПлатежСоставПлатежей.НазначениеПлатежа,
	|	абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала КАК НомерНедели,
	|	абс_ПлатежСоставПлатежей.Счет.Комментарий КАК Комментарий
	|	,абс_МеппингСтатейДДСиСтатейБюджета.СтатьяДДСНаименование КАК БюджетнаяСтатьяСтар
	|ИЗ
	|	Документ.абс_Платеж.СоставПлатежей КАК абс_ПлатежСоставПлатежей
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.абс_МеппингСтатейДДСиСтатейБюджета КАК абс_МеппингСтатейДДСиСтатейБюджета
	|		ПО абс_ПлатежСоставПлатежей.Счет.БюджетнаяСтатья = абс_МеппингСтатейДДСиСтатейБюджета.БюджетнаяСтатья

	|ГДЕ
	|	(НЕ абс_ПлатежСоставПлатежей.Ссылка.ПометкаУдаления)
	|	И (НЕ абс_ПлатежСоставПлатежей.Ссылка.СтатусПлана = ЗНАЧЕНИЕ(Перечисление.абс_СтатусыПланаПлатежей.Разутвержден))
	|	И абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья В ИЕРАРХИИ(&ГруппаСтатейОборотов)
	|	И абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала = &НомерНедели
	|
	|УПОРЯДОЧИТЬ ПО
	|	КонтрагентНаименованиеПП,
	|	Сумма УБЫВ
	|ИТОГИ
	|	СУММА(Сумма)
	|ПО
	|	ОБЩИЕ";
	Запрос.УстановитьПараметр("ГруппаСтатейОборотов", БюджетныеСтатьиСИ);
	
	ВыборкаОбщая = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	
	// 7.
	
	Если ВыборкаОбщая.Следующий() Тогда
		
		ВыборкаПоСтрокам = ВыборкаОбщая.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		Пока ВыборкаПоСтрокам.Следующий() Цикл
			
			ЗаполнитьЗначенияСвойств(ОбластьСтрокаПоКонтрагенту.Параметры, ВыборкаПоСтрокам);
			ТабДокумент.Вывести(ОбластьСтрокаПоКонтрагенту);
			НайденныеСтроки = ВыведенныеСтроки.НайтиСтроки(Новый Структура("НомерСтроки, Документ", ВыборкаПоСтрокам.НомерСтроки, ВыборкаПоСтрокам.Документ));
			
			Если НайденныеСтроки.Количество() Тогда 
				Сообщить("Строка №" + ВыборкаПоСтрокам.НомерСтроки + " из документа " + ВыборкаПоСтрокам.Документ + " уже выводилась!");
			Иначе
				ЗаполнитьЗначенияСвойств(ВыведенныеСтроки.Добавить(), ВыборкаПоСтрокам);
			КонецЕсли;
			
		КонецЦикла;
		
		ОбластьИтогиПоВиду.Параметры.Сумма = ВыборкаОбщая.Сумма;
		ИтогиРасходыОперационнаяДеятельность = ИтогиРасходыОперационнаяДеятельность + ВыборкаОбщая.Сумма; 
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	Иначе
		
		ОбластьИтогиПоВиду.Параметры.Сумма = 0;
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	КонецЕсли;
	
	ОбластьЗаголовокРазмер10.Параметры.Заголовок = "Операционные расходы. Эксплуатация.";
	ТабДокумент.Вывести(ОбластьЗаголовокРазмер10);
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	абс_ПлатежСоставПлатежей.Ссылка КАК Документ,
	|	абс_ПлатежСоставПлатежей.НомерСтроки,
	|	абс_ПлатежСоставПлатежей.Контрагент КАК Контрагент,
	|	ВЫБОР
	|		КОГДА абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП = """"
	|			ТОГДА абс_ПлатежСоставПлатежей.Контрагент.Наименование
	|		ИНАЧЕ абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП
	|	КОНЕЦ КАК КонтрагентНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО.абс_НаименованиеПП КАК ЦФОНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья,
	|	абс_ПлатежСоставПлатежей.СуммаПлатежа КАК Сумма,
	|	абс_ПлатежСоставПлатежей.ОснованиеПлатежа,
	|	абс_ПлатежСоставПлатежей.НазначениеПлатежа,
	|	абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала КАК НомерНедели,
	|	абс_ПлатежСоставПлатежей.Счет.Комментарий КАК Комментарий
	|	,абс_МеппингСтатейДДСиСтатейБюджета.СтатьяДДСНаименование КАК БюджетнаяСтатьяСтар
	|ИЗ
	|	Документ.абс_Платеж.СоставПлатежей КАК абс_ПлатежСоставПлатежей
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.абс_МеппингСтатейДДСиСтатейБюджета КАК абс_МеппингСтатейДДСиСтатейБюджета
	|		ПО абс_ПлатежСоставПлатежей.Счет.БюджетнаяСтатья = абс_МеппингСтатейДДСиСтатейБюджета.БюджетнаяСтатья

	|ГДЕ
	|	(НЕ абс_ПлатежСоставПлатежей.Ссылка.ПометкаУдаления)
	|	И (НЕ абс_ПлатежСоставПлатежей.Ссылка.СтатусПлана = ЗНАЧЕНИЕ(Перечисление.абс_СтатусыПланаПлатежей.Разутвержден))
	|	И (НЕ абс_ПлатежСоставПлатежей.Счет.Контрагент.абс_ТипыКонтрагентов В ИЕРАРХИИ (ЗНАЧЕНИЕ(Справочник.абс_ТипыКонтрагентов.ХТТК)))
	|	И абс_ПлатежСоставПлатежей.Ссылка.ЦФУ = &ЦФУ
	|	И абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья В ИЕРАРХИИ(&ГруппаСтатейОборотов)
	|	И абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала = &НомерНедели
	|
	|УПОРЯДОЧИТЬ ПО
	|	КонтрагентНаименованиеПП,
	|	Сумма УБЫВ
	|ИТОГИ
	|	СУММА(Сумма)
	|ПО
	|	ОБЩИЕ";
	Запрос.УстановитьПараметр("ЦФУ", ЦФУ_Эксплуатация);
	Запрос.УстановитьПараметр("ГруппаСтатейОборотов", БюджетныеСтатьиЭксплуатация);
	
	ВыборкаОбщая = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	
	// 8.
	
	Если ВыборкаОбщая.Следующий() Тогда
		
		ВыборкаПоСтрокам = ВыборкаОбщая.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		Пока ВыборкаПоСтрокам.Следующий() Цикл
			
			ЗаполнитьЗначенияСвойств(ОбластьСтрокаПоКонтрагенту.Параметры, ВыборкаПоСтрокам);
			ТабДокумент.Вывести(ОбластьСтрокаПоКонтрагенту);
			НайденныеСтроки = ВыведенныеСтроки.НайтиСтроки(Новый Структура("НомерСтроки, Документ", ВыборкаПоСтрокам.НомерСтроки, ВыборкаПоСтрокам.Документ));
			
			Если НайденныеСтроки.Количество() Тогда 
				Сообщить("Строка №" + ВыборкаПоСтрокам.НомерСтроки + " из документа " + ВыборкаПоСтрокам.Документ + " уже выводилась!");
			Иначе
				ЗаполнитьЗначенияСвойств(ВыведенныеСтроки.Добавить(), ВыборкаПоСтрокам);
			КонецЕсли;
			
		КонецЦикла;
		
		ОбластьИтогиПоВиду.Параметры.Сумма = ВыборкаОбщая.Сумма;
		ИтогиРасходыОперационнаяДеятельность = ИтогиРасходыОперационнаяДеятельность + ВыборкаОбщая.Сумма; 
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	Иначе
		
		ОбластьИтогиПоВиду.Параметры.Сумма = 0;
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	КонецЕсли;

	ОбластьЗаголовокРазмер10.Параметры.Заголовок = "РЖД. Аренда сети и возмещение ТО.";
	ТабДокумент.Вывести(ОбластьЗаголовокРазмер10);
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	абс_ПлатежСоставПлатежей.Ссылка КАК Документ,
	|	абс_ПлатежСоставПлатежей.НомерСтроки,
	|	абс_ПлатежСоставПлатежей.Контрагент КАК Контрагент,
	|	ВЫБОР
	|		КОГДА абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП = """"
	|			ТОГДА абс_ПлатежСоставПлатежей.Контрагент.Наименование
	|		ИНАЧЕ абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП
	|	КОНЕЦ КАК КонтрагентНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО.абс_НаименованиеПП КАК ЦФОНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья,
	|	абс_ПлатежСоставПлатежей.СуммаПлатежа КАК Сумма,
	|	абс_ПлатежСоставПлатежей.ОснованиеПлатежа,
	|	абс_ПлатежСоставПлатежей.НазначениеПлатежа,
	|	абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала КАК НомерНедели,
	|	абс_ПлатежСоставПлатежей.Счет.Комментарий КАК Комментарий
	|	,абс_МеппингСтатейДДСиСтатейБюджета.СтатьяДДСНаименование КАК БюджетнаяСтатьяСтар
	|ИЗ
	|	Документ.абс_Платеж.СоставПлатежей КАК абс_ПлатежСоставПлатежей
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.абс_МеппингСтатейДДСиСтатейБюджета КАК абс_МеппингСтатейДДСиСтатейБюджета
	|		ПО абс_ПлатежСоставПлатежей.Счет.БюджетнаяСтатья = абс_МеппингСтатейДДСиСтатейБюджета.БюджетнаяСтатья

	|ГДЕ
	|	(НЕ абс_ПлатежСоставПлатежей.Ссылка.ПометкаУдаления)
	|	И (НЕ абс_ПлатежСоставПлатежей.Ссылка.СтатусПлана = ЗНАЧЕНИЕ(Перечисление.абс_СтатусыПланаПлатежей.Разутвержден))
	|	И абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья В ИЕРАРХИИ(&БюджетныеСтатьиПРСЭ0101_0102)
	|	И абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала = &НомерНедели
	|	И абс_ПлатежСоставПлатежей.Счет.Контрагент.абс_ТипыКонтрагентов = ЗНАЧЕНИЕ(Справочник.абс_ТипыКонтрагентов.РЖДбезДЗО)
	|
	|УПОРЯДОЧИТЬ ПО
	|	КонтрагентНаименованиеПП,
	|	Сумма УБЫВ
	|ИТОГИ
	|	СУММА(Сумма)
	|ПО
	|	ОБЩИЕ";
	
	ВыборкаОбщая = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	
	// 9.
	
	Если ВыборкаОбщая.Следующий() Тогда
		
		ВыборкаПоСтрокам = ВыборкаОбщая.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		Пока ВыборкаПоСтрокам.Следующий() Цикл
			
			ЗаполнитьЗначенияСвойств(ОбластьСтрокаПоКонтрагенту.Параметры, ВыборкаПоСтрокам);
			ТабДокумент.Вывести(ОбластьСтрокаПоКонтрагенту);
			НайденныеСтроки = ВыведенныеСтроки.НайтиСтроки(Новый Структура("НомерСтроки, Документ", ВыборкаПоСтрокам.НомерСтроки, ВыборкаПоСтрокам.Документ));
			
			Если НайденныеСтроки.Количество() Тогда 
				Сообщить("Строка №" + ВыборкаПоСтрокам.НомерСтроки + " из документа " + ВыборкаПоСтрокам.Документ + " уже выводилась!");
			Иначе
				ЗаполнитьЗначенияСвойств(ВыведенныеСтроки.Добавить(), ВыборкаПоСтрокам);
			КонецЕсли;
			
		КонецЦикла;
		
		ОбластьИтогиПоВиду.Параметры.Сумма = ВыборкаОбщая.Сумма;
		ИтогиРасходыОперационнаяДеятельность = ИтогиРасходыОперационнаяДеятельность + ВыборкаОбщая.Сумма; 
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	Иначе
		
		ОбластьИтогиПоВиду.Параметры.Сумма = 0;
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	КонецЕсли;
	
	ОбластьЗаголовокРазмер10.Параметры.Заголовок = "Административные и внеоперационные расходы.";
	ТабДокумент.Вывести(ОбластьЗаголовокРазмер10);
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	абс_ПлатежСоставПлатежей.Ссылка КАК Документ,
	|	абс_ПлатежСоставПлатежей.НомерСтроки,
	|	абс_ПлатежСоставПлатежей.Контрагент КАК Контрагент,
	|	ВЫБОР
	|		КОГДА абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП = """"
	|			ТОГДА абс_ПлатежСоставПлатежей.Контрагент.Наименование
	|		ИНАЧЕ абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП
	|	КОНЕЦ КАК КонтрагентНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО.абс_НаименованиеПП КАК ЦФОНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья,
	|	абс_ПлатежСоставПлатежей.СуммаПлатежа КАК Сумма,
	|	абс_ПлатежСоставПлатежей.ОснованиеПлатежа,
	|	абс_ПлатежСоставПлатежей.НазначениеПлатежа,
	|	абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала КАК НомерНедели,
	|	абс_ПлатежСоставПлатежей.Счет.Комментарий КАК Комментарий
	|	,абс_МеппингСтатейДДСиСтатейБюджета.СтатьяДДСНаименование КАК БюджетнаяСтатьяСтар
	|ИЗ
	|	Документ.абс_Платеж.СоставПлатежей КАК абс_ПлатежСоставПлатежей
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.абс_МеппингСтатейДДСиСтатейБюджета КАК абс_МеппингСтатейДДСиСтатейБюджета
	|		ПО абс_ПлатежСоставПлатежей.Счет.БюджетнаяСтатья = абс_МеппингСтатейДДСиСтатейБюджета.БюджетнаяСтатья

	|ГДЕ
	|	(НЕ абс_ПлатежСоставПлатежей.Ссылка.ПометкаУдаления)
	|	И (НЕ абс_ПлатежСоставПлатежей.Ссылка.СтатусПлана = ЗНАЧЕНИЕ(Перечисление.абс_СтатусыПланаПлатежей.Разутвержден))
	|	И (НЕ абс_ПлатежСоставПлатежей.Счет.Контрагент.абс_ТипыКонтрагентов В ИЕРАРХИИ (ЗНАЧЕНИЕ(Справочник.абс_ТипыКонтрагентов.ХТТК)))
	|	И абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья В ИЕРАРХИИ(&ГруппаСтатейОборотов)
	|	И НЕ абс_ПлатежСоставПлатежей.Счет.СтатьяДвиженияДенежныхСредств.ВидДвиженияДенежныхСредств = ЗНАЧЕНИЕ(Перечисление.ВидыДвиженийДенежныхСредств.РасчетыПоНалогамИСборам)
	|	И абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала = &НомерНедели
	|
	|УПОРЯДОЧИТЬ ПО
	|	КонтрагентНаименованиеПП,
	|	Сумма УБЫВ
	|ИТОГИ
	|	СУММА(Сумма)
	|ПО
	|	ОБЩИЕ";
	Запрос.УстановитьПараметр("ГруппаСтатейОборотов", БюджетныеСтатьиКосвенныеПрочие);
	
	ВыборкаОбщая = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	
	// 10.
	
	Если ВыборкаОбщая.Следующий() Тогда
		
		ВыборкаПоСтрокам = ВыборкаОбщая.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		Пока ВыборкаПоСтрокам.Следующий() Цикл
			
			ЗаполнитьЗначенияСвойств(ОбластьСтрокаПоКонтрагенту.Параметры, ВыборкаПоСтрокам);
			ТабДокумент.Вывести(ОбластьСтрокаПоКонтрагенту);
			НайденныеСтроки = ВыведенныеСтроки.НайтиСтроки(Новый Структура("НомерСтроки, Документ", ВыборкаПоСтрокам.НомерСтроки, ВыборкаПоСтрокам.Документ));
			
			Если НайденныеСтроки.Количество() Тогда 
				Сообщить("Строка №" + ВыборкаПоСтрокам.НомерСтроки + " из документа " + ВыборкаПоСтрокам.Документ + " уже выводилась!");
			Иначе
				ЗаполнитьЗначенияСвойств(ВыведенныеСтроки.Добавить(), ВыборкаПоСтрокам);
			КонецЕсли;
			
		КонецЦикла;
		
		ОбластьИтогиПоВиду.Параметры.Сумма = ВыборкаОбщая.Сумма;
		ИтогиРасходыОперационнаяДеятельность = ИтогиРасходыОперационнаяДеятельность + ВыборкаОбщая.Сумма; 
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	Иначе
		
		ОбластьИтогиПоВиду.Параметры.Сумма = 0;
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	КонецЕсли;
	
	ОбластьЗаголовокРазмер10.Параметры.Заголовок = "Налоги. Дивиденды.";
	ТабДокумент.Вывести(ОбластьЗаголовокРазмер10);
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	абс_ПлатежСоставПлатежей.Ссылка КАК Документ,
	|	абс_ПлатежСоставПлатежей.НомерСтроки,
	|	абс_ПлатежСоставПлатежей.Контрагент КАК Контрагент,
	|	ВЫБОР
	|		КОГДА абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП = """"
	|			ТОГДА абс_ПлатежСоставПлатежей.Контрагент.Наименование
	|		ИНАЧЕ абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП
	|	КОНЕЦ КАК КонтрагентНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО.абс_НаименованиеПП КАК ЦФОНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья,
	|	абс_ПлатежСоставПлатежей.СуммаПлатежа КАК Сумма,
	|	абс_ПлатежСоставПлатежей.ОснованиеПлатежа,
	|	абс_ПлатежСоставПлатежей.НазначениеПлатежа,
	|	абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала КАК НомерНедели,
	|	абс_ПлатежСоставПлатежей.Счет.Комментарий КАК Комментарий
	|	,абс_МеппингСтатейДДСиСтатейБюджета.СтатьяДДСНаименование КАК БюджетнаяСтатьяСтар
	|ИЗ
	|	Документ.абс_Платеж.СоставПлатежей КАК абс_ПлатежСоставПлатежей
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.абс_МеппингСтатейДДСиСтатейБюджета КАК абс_МеппингСтатейДДСиСтатейБюджета
	|		ПО абс_ПлатежСоставПлатежей.Счет.БюджетнаяСтатья = абс_МеппингСтатейДДСиСтатейБюджета.БюджетнаяСтатья

	|ГДЕ
	|	(НЕ абс_ПлатежСоставПлатежей.Ссылка.ПометкаУдаления)
	|	И (НЕ абс_ПлатежСоставПлатежей.Ссылка.СтатусПлана = ЗНАЧЕНИЕ(Перечисление.абс_СтатусыПланаПлатежей.Разутвержден))
	|	И абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала = &НомерНедели
	|	И абс_ПлатежСоставПлатежей.Счет.СтатьяДвиженияДенежныхСредств.ВидДвиженияДенежныхСредств = ЗНАЧЕНИЕ(Перечисление.ВидыДвиженийДенежныхСредств.РасчетыПоНалогамИСборам)
	|
	|УПОРЯДОЧИТЬ ПО
	|	КонтрагентНаименованиеПП,
	|	Сумма УБЫВ
	|ИТОГИ
	|	СУММА(Сумма)
	|ПО
	|	ОБЩИЕ";
	
	ВыборкаОбщая = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	
	// 11.
	
	Если ВыборкаОбщая.Следующий() Тогда
		
		ВыборкаПоСтрокам = ВыборкаОбщая.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		Пока ВыборкаПоСтрокам.Следующий() Цикл
			
			ЗаполнитьЗначенияСвойств(ОбластьСтрокаПоКонтрагенту.Параметры, ВыборкаПоСтрокам);
			ТабДокумент.Вывести(ОбластьСтрокаПоКонтрагенту);
			НайденныеСтроки = ВыведенныеСтроки.НайтиСтроки(Новый Структура("НомерСтроки, Документ", ВыборкаПоСтрокам.НомерСтроки, ВыборкаПоСтрокам.Документ));
			
			Если НайденныеСтроки.Количество() Тогда 
				Сообщить("Строка №" + ВыборкаПоСтрокам.НомерСтроки + " из документа " + ВыборкаПоСтрокам.Документ + " уже выводилась!");
			Иначе
				ЗаполнитьЗначенияСвойств(ВыведенныеСтроки.Добавить(), ВыборкаПоСтрокам);
			КонецЕсли;
			
		КонецЦикла;
		
		ОбластьИтогиПоВиду.Параметры.Сумма = ВыборкаОбщая.Сумма;
		ИтогиРасходыОперационнаяДеятельность = ИтогиРасходыОперационнаяДеятельность + ВыборкаОбщая.Сумма; 
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	Иначе
		
		ОбластьИтогиПоВиду.Параметры.Сумма = 0;
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	КонецЕсли;
	
	ОбластьИтогиПоВидуДеятельности.Параметры.Сумма = ИтогиРасходыОперационнаяДеятельность;
	ОбластьИтогиПоВидуДеятельности.Параметры.Заголовок = "ИТОГО ОПЕРАЦИОННАЯ ДЕЯТЕЛЬНОСТЬ:";
	ТабДокумент.Вывести(ОбластьИтогиПоВидуДеятельности);
	
	ОбластьЗаголовокРазмер10.Параметры.Заголовок = "ИНВЕСТИЦИОННАЯ ДЕЯТЕЛЬНОСТЬ.";
	ТабДокумент.Вывести(ОбластьЗаголовокРазмер10);
	
	ОбластьЗаголовокРазмер10.Параметры.Заголовок = "Х-ТТК. Капвложения.";
	ТабДокумент.Вывести(ОбластьЗаголовокРазмер10);
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	абс_ПлатежСоставПлатежей.Ссылка КАК Документ,
	|	абс_ПлатежСоставПлатежей.НомерСтроки,
	|	абс_ПлатежСоставПлатежей.Контрагент КАК Контрагент,
	|	ВЫБОР
	|		КОГДА абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП = """"
	|			ТОГДА абс_ПлатежСоставПлатежей.Контрагент.Наименование
	|		ИНАЧЕ абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП
	|	КОНЕЦ КАК КонтрагентНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО.абс_НаименованиеПП КАК ЦФОНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья,
	|	абс_ПлатежСоставПлатежей.СуммаПлатежа КАК Сумма,
	|	абс_ПлатежСоставПлатежей.ОснованиеПлатежа,
	|	абс_ПлатежСоставПлатежей.НазначениеПлатежа,
	|	абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала КАК НомерНедели,
	|	абс_ПлатежСоставПлатежей.Счет.Комментарий КАК Комментарий
	|	,абс_МеппингСтатейДДСиСтатейБюджета.СтатьяДДСНаименование КАК БюджетнаяСтатьяСтар
	|ИЗ
	|	Документ.абс_Платеж.СоставПлатежей КАК абс_ПлатежСоставПлатежей
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.абс_МеппингСтатейДДСиСтатейБюджета КАК абс_МеппингСтатейДДСиСтатейБюджета
	|		ПО абс_ПлатежСоставПлатежей.Счет.БюджетнаяСтатья = абс_МеппингСтатейДДСиСтатейБюджета.БюджетнаяСтатья

	|ГДЕ
	|	(НЕ абс_ПлатежСоставПлатежей.Ссылка.ПометкаУдаления)
	|	И (НЕ абс_ПлатежСоставПлатежей.Ссылка.СтатусПлана = ЗНАЧЕНИЕ(Перечисление.абс_СтатусыПланаПлатежей.Разутвержден))
	|	И абс_ПлатежСоставПлатежей.Счет.Контрагент.абс_ТипыКонтрагентов В ИЕРАРХИИ (ЗНАЧЕНИЕ(Справочник.абс_ТипыКонтрагентов.ХТТК))
	|	И абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья В ИЕРАРХИИ(&ГруппаСтатейОборотов)
	|	И абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала = &НомерНедели
	|
	|УПОРЯДОЧИТЬ ПО
	|	КонтрагентНаименованиеПП,
	|	Сумма УБЫВ
	|ИТОГИ
	|	СУММА(Сумма)
	|ПО
	|	ОБЩИЕ,
	|	Контрагент";
	Запрос.УстановитьПараметр("ГруппаСтатейОборотов", БюджетныеСтатьиКапвложения);
	
	ВыборкаОбщая = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	
	// 12.
	
	Если ВыборкаОбщая.Следующий() Тогда
		
		ВыборкаПоКонтрагенту = ВыборкаОбщая.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		Пока ВыборкаПоКонтрагенту.Следующий() Цикл
			
			ВыборкаПоСтрокам = ВыборкаПоКонтрагенту.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
			
			Пока ВыборкаПоСтрокам.Следующий() Цикл
				
				ЗаполнитьЗначенияСвойств(ОбластьСтрокаПоКонтрагенту.Параметры, ВыборкаПоСтрокам);
				ТабДокумент.Вывести(ОбластьСтрокаПоКонтрагенту);
				НайденныеСтроки = ВыведенныеСтроки.НайтиСтроки(Новый Структура("НомерСтроки, Документ", ВыборкаПоСтрокам.НомерСтроки, ВыборкаПоСтрокам.Документ));
				
				Если НайденныеСтроки.Количество() Тогда 
					Сообщить("Строка №" + ВыборкаПоСтрокам.НомерСтроки + " из документа " + ВыборкаПоСтрокам.Документ + " уже выводилась!");
				Иначе
					ЗаполнитьЗначенияСвойств(ВыведенныеСтроки.Добавить(), ВыборкаПоСтрокам);
				КонецЕсли;
				
			КонецЦикла;
			
			ЗаполнитьЗначенияСвойств(ОбластьИтогиПоКонтрагенту4.Параметры, ВыборкаПоКонтрагенту);
			ТабДокумент.Вывести(ОбластьИтогиПоКонтрагенту4);
			
		КонецЦикла;
		
		ОбластьИтогиПоВиду.Параметры.Сумма = ВыборкаОбщая.Сумма;
		ИтогиРасходыИнвестиционнаяДеятельность = ИтогиРасходыИнвестиционнаяДеятельность + ВыборкаОбщая.Сумма; 
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	Иначе
		
		ОбластьИтогиПоВиду.Параметры.Сумма = 0;
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	КонецЕсли;
	
	ОбластьЗаголовокРазмер10.Параметры.Заголовок = "Капитальные вложения. Прочие.";
	ТабДокумент.Вывести(ОбластьЗаголовокРазмер10);
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	абс_ПлатежСоставПлатежей.Ссылка КАК Документ,
	|	абс_ПлатежСоставПлатежей.НомерСтроки,
	|	абс_ПлатежСоставПлатежей.Контрагент КАК Контрагент,
	|	ВЫБОР
	|		КОГДА абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП = """"
	|			ТОГДА абс_ПлатежСоставПлатежей.Контрагент.Наименование
	|		ИНАЧЕ абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП
	|	КОНЕЦ КАК КонтрагентНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО.абс_НаименованиеПП КАК ЦФОНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья,
	|	абс_ПлатежСоставПлатежей.СуммаПлатежа КАК Сумма,
	|	абс_ПлатежСоставПлатежей.ОснованиеПлатежа,
	|	абс_ПлатежСоставПлатежей.НазначениеПлатежа,
	|	абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала КАК НомерНедели,
	|	абс_ПлатежСоставПлатежей.Счет.Комментарий КАК Комментарий
	|	,абс_МеппингСтатейДДСиСтатейБюджета.СтатьяДДСНаименование КАК БюджетнаяСтатьяСтар
	|ИЗ
	|	Документ.абс_Платеж.СоставПлатежей КАК абс_ПлатежСоставПлатежей
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.абс_МеппингСтатейДДСиСтатейБюджета КАК абс_МеппингСтатейДДСиСтатейБюджета
	|		ПО абс_ПлатежСоставПлатежей.Счет.БюджетнаяСтатья = абс_МеппингСтатейДДСиСтатейБюджета.БюджетнаяСтатья

	|ГДЕ
	|	(НЕ абс_ПлатежСоставПлатежей.Ссылка.ПометкаУдаления)
	|	И (НЕ абс_ПлатежСоставПлатежей.Ссылка.СтатусПлана = ЗНАЧЕНИЕ(Перечисление.абс_СтатусыПланаПлатежей.Разутвержден))
	|	И (НЕ абс_ПлатежСоставПлатежей.Счет.Контрагент.абс_ТипыКонтрагентов В ИЕРАРХИИ (ЗНАЧЕНИЕ(Справочник.абс_ТипыКонтрагентов.ХТТК)))
	|	И абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья В ИЕРАРХИИ(&ГруппаСтатейОборотов)
	|	И абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала = &НомерНедели
	|
	|УПОРЯДОЧИТЬ ПО
	|	КонтрагентНаименованиеПП,
	|	Сумма УБЫВ
	|ИТОГИ
	|	СУММА(Сумма)
	|ПО
	|	ОБЩИЕ";
	Запрос.УстановитьПараметр("ГруппаСтатейОборотов", БюджетныеСтатьиКапвложения);
	
	ВыборкаОбщая = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	
	// 13.
	
	Если ВыборкаОбщая.Следующий() Тогда
		
		ВыборкаПоСтрокам = ВыборкаОбщая.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		Пока ВыборкаПоСтрокам.Следующий() Цикл
			
			ЗаполнитьЗначенияСвойств(ОбластьСтрокаПоКонтрагенту.Параметры, ВыборкаПоСтрокам);
			ТабДокумент.Вывести(ОбластьСтрокаПоКонтрагенту);
			НайденныеСтроки = ВыведенныеСтроки.НайтиСтроки(Новый Структура("НомерСтроки, Документ", ВыборкаПоСтрокам.НомерСтроки, ВыборкаПоСтрокам.Документ));
			
			Если НайденныеСтроки.Количество() Тогда 
				Сообщить("Строка №" + ВыборкаПоСтрокам.НомерСтроки + " из документа " + ВыборкаПоСтрокам.Документ + " уже выводилась!");
			Иначе
				ЗаполнитьЗначенияСвойств(ВыведенныеСтроки.Добавить(), ВыборкаПоСтрокам);
			КонецЕсли;
			
		КонецЦикла;
		
		ОбластьИтогиПоВиду.Параметры.Сумма = ВыборкаОбщая.Сумма;
		ИтогиРасходыИнвестиционнаяДеятельность = ИтогиРасходыИнвестиционнаяДеятельность + ВыборкаОбщая.Сумма; 
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	Иначе
		
		ОбластьИтогиПоВиду.Параметры.Сумма = 0;
		ТабДокумент.Вывести(ОбластьИтогиПоВиду);
		
	КонецЕсли;
	
	ОбластьИтогиПоВидуДеятельности.Параметры.Сумма = ИтогиРасходыИнвестиционнаяДеятельность;
	ОбластьИтогиПоВидуДеятельности.Параметры.Заголовок = "ИТОГО ИНВЕСТИЦИОННАЯ ДЕЯТЕЛЬНОСТЬ:";
	ТабДокумент.Вывести(ОбластьИтогиПоВидуДеятельности);
	
	ТабДокумент.Вывести(ОбластьГруппаФинансоваяДеятельность);
	
	ОбластьПодвал.Параметры.Сумма = ИтогиРасходыИнвестиционнаяДеятельность + ИтогиРасходыОперационнаяДеятельность;
	ТабДокумент.Вывести(ОбластьПодвал);
	
	Запрос.Текст =
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	абс_ПлатежСоставПлатежей.Ссылка КАК Документ,
	|	абс_ПлатежСоставПлатежей.НомерСтроки,
	|	абс_ПлатежСоставПлатежей.Контрагент КАК Контрагент,
	|	ВЫБОР
	|		КОГДА абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП = """"
	|			ТОГДА абс_ПлатежСоставПлатежей.Контрагент.Наименование
	|		ИНАЧЕ абс_ПлатежСоставПлатежей.Контрагент.абс_НаименованиеПП
	|	КОНЕЦ КАК КонтрагентНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО,
	|	абс_ПлатежСоставПлатежей.Ссылка.ЦФО.абс_НаименованиеПП КАК ЦФОНаименованиеПП,
	|	абс_ПлатежСоставПлатежей.Ссылка.БюджетнаяСтатья,
	|	абс_ПлатежСоставПлатежей.СуммаПлатежа КАК Сумма,
	|	абс_ПлатежСоставПлатежей.ОснованиеПлатежа,
	|	абс_ПлатежСоставПлатежей.НазначениеПлатежа,
	|	абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала КАК НомерНедели,
	|	абс_ПлатежСоставПлатежей.Счет.Комментарий КАК Комментарий,
	|	абс_МеппингСтатейДДСиСтатейБюджета.СтатьяДДСНаименование КАК БюджетнаяСтатьяСтар
	|ИЗ
	|	Документ.абс_Платеж.СоставПлатежей КАК абс_ПлатежСоставПлатежей
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.абс_МеппингСтатейДДСиСтатейБюджета КАК абс_МеппингСтатейДДСиСтатейБюджета
	|		ПО абс_ПлатежСоставПлатежей.Счет.БюджетнаяСтатья = абс_МеппингСтатейДДСиСтатейБюджета.БюджетнаяСтатья
	|ГДЕ
	|	(НЕ абс_ПлатежСоставПлатежей.Ссылка.ПометкаУдаления)
	|	И (НЕ абс_ПлатежСоставПлатежей.Ссылка.СтатусПлана = ЗНАЧЕНИЕ(Перечисление.абс_СтатусыПланаПлатежей.Разутвержден))
	|	И абс_ПлатежСоставПлатежей.Ссылка.НомерЖурнала = &НомерНедели
	|	И НАЧАЛОПЕРИОДА(абс_ПлатежСоставПлатежей.Ссылка.ДатаНачала, ГОД) = НАЧАЛОПЕРИОДА(&ДатаКон, ГОД)
	|
	|УПОРЯДОЧИТЬ ПО
	|	КонтрагентНаименованиеПП,
	|	Сумма УБЫВ
	|ИТОГИ
	|	СУММА(Сумма)
	|ПО
	|	ОБЩИЕ";
	Запрос.УстановитьПараметр("ДатаКон", НачалоГода(ДатаНачала));
	Выборка = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	
	ШапкаВыведена = Ложь;
	
	Пока Выборка.Следующий() Цикл
		
		ВыборкаПоСтрокам = Выборка.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		Пока ВыборкаПоСтрокам.Следующий() Цикл

			НайденныеСтроки = ВыведенныеСтроки.НайтиСтроки(Новый Структура("НомерСтроки, Документ", Выборка.НомерСтроки, Выборка.Документ));
			
			Если НЕ НайденныеСтроки.Количество() Тогда
				//Сообщить("Строка №" + Выборка.НомерСтроки + " из документа " + Выборка.Документ + " не выводилась на печать!");
				
				Если НЕ ШапкаВыведена Тогда
					ЗаполнитьЗначенияСвойств(ОбластьШапкаНераспределенные.Параметры, Выборка);
					ТабДокумент.Вывести(ОбластьШапкаНераспределенные);
					ШапкаВыведена = Истина;
				КонецЕсли;
				
				ЗаполнитьЗначенияСвойств(ОбластьСтрокаНераспределенные.Параметры, ВыборкаПоСтрокам);
				ТабДокумент.Вывести(ОбластьСтрокаНераспределенные);
				
			КонецЕсли;
		
		КонецЦикла;
		
	КонецЦикла;	
	
	Возврат ТабДокумент;
	
КонецФункции

Процедура Печать(ИмяМакета, КоличествоЭкземпляров = 1, НаПринтер = Ложь) Экспорт

	Если ЭтоНовый() Тогда
		ОбщегоНазначенияКлиентСервер.СообщитьПользователю(НСтр("ru = 'Документ можно распечатать только после его записи'"));
		Возврат;
	КонецЕсли;

	Если Не РаботаСДиалогами.ПроверитьМодифицированность(ЭтотОбъект) Тогда
		Возврат;
	КонецЕсли;

	// Получить экземпляр документа на печать
	Если ИмяМакета = "ПланПлатежей" тогда

		ТабДокумент = ПечатьПланаПлатежей();
	ИначеЕсли ИмяМакета = "ПланПлатежейПоДокументу" Тогда
		
		ТабДокумент = ПечатьПланаПлатежейПоДокументу();
	
	КонецЕсли;

	УниверсальныеМеханизмы.НапечататьДокумент(ТабДокумент, КоличествоЭкземпляров, НаПринтер, ttk_ОбщегоНазначения.СформироватьЗаголовокДокумента(ЭтотОбъект), Ссылка);

КонецПроцедуры // Печать

// Возвращает доступные варианты печати документа
//
// Возвращаемое значение:
//  Структура, каждая строка которой соответствует одному из вариантов печати
//  
Функция ПолучитьСтруктуруПечатныхФорм() Экспорт
	
	СтруктураМакетов = Новый Структура;

	//СтруктураМакетов.Вставить("ПланПлатежей"			,          "План платежей");
	СтруктураМакетов.Вставить("ПланПлатежейПоДокументу"	,          "План платежей (по документу)");

	Возврат СтруктураМакетов;

КонецФункции // ПолучитьСтруктуруПечатныхФорм()

Функция ПолучитьЗаголовокКолонки(ТекПериод) Экспорт
	
	ДеньНедели = ДеньНедели(ТекПериод);
	
	ЗаголовокПериод = "";
	
	Если ДеньНедели = 1 Тогда
		ЗаголовокПериод = "пн, ";
	ИначеЕсли ДеньНедели = 2 Тогда
		ЗаголовокПериод = "вт, ";
	ИначеЕсли ДеньНедели = 3 Тогда
		ЗаголовокПериод = "ср, ";
	ИначеЕсли ДеньНедели = 4 Тогда
		ЗаголовокПериод = "чт, ";
	ИначеЕсли ДеньНедели = 5 Тогда
		ЗаголовокПериод = "пт, ";
	ИначеЕсли ДеньНедели = 6 Тогда
		ЗаголовокПериод = "сб, ";
	ИначеЕсли ДеньНедели = 7 Тогда
		ЗаголовокПериод = "вс, ";
	КонецЕсли;
	
	ЗаголовокПериод = ЗаголовокПериод + Формат(ТекПериод, "ДФ=dd.MM");
	
	Возврат ЗаголовокПериод;
	
КонецФункции

Функция ПолучитьСтруктуруЗаголовковШапки()
	
	СтруктураЗаголовков = Новый Структура;
	
	ТекПериод = ДатаНачала;
	
	Для Н = 1 по 7 Цикл
		
		СтруктураЗаголовков.Вставить("ЗаголовокСуммаФактДень" + Н, ПолучитьЗаголовокКолонки(ТекПериод));
		
		ТекПериод = ТекПериод + 24*60*60;
		
	КонецЦикла;
	
	Возврат СтруктураЗаголовков;
	
КонецФункции

Функция ПолучитьСтруктуруИтогов()
	
	СтруктураИтогов = Новый Структура;
	
	Ноль = 0;
	
	Для Н = 1 по 7 Цикл
		
		СтруктураИтогов.Вставить("СуммаФактДень" + Н, Ноль);
		
	КонецЦикла;
	
	СтруктураИтогов.Вставить("СуммаФактИтого", Ноль);
	СтруктураИтогов.Вставить("СуммаСчета", Ноль);
	
	Возврат СтруктураИтогов;
	
КонецФункции
