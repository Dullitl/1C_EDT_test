
Функция ПолучитьСтруктуруЗапросовПроведения() Экспорт

	СтруктураЗапросов = Новый Структура;
	ДобавитьОбщиеЗапросы(СтруктураЗапросов);
	ДобавитьЗапросыДляРазукрупнения(СтруктураЗапросов);
	
	Возврат СтруктураЗапросов;

КонецФункции

Процедура ДобавитьЗапросыДляРазукрупнения(СтруктураЗапросов)

	ТекстЗапроса = 
		"ВЫБРАТЬ
		|	ПериодыРегистраторыСреза.Период,
		|	ПериодыРегистраторыСреза.Регистратор,
		|	ПериодыРегистраторыСреза.ОсновноеСредство КАК ОсновноеСредство,
		|	ОсновныеСредстваМеждународныйУчет.Организация,
		|	ОсновныеСредстваМеждународныйУчет.ДатаПринятияКУчету,
		|	ОсновныеСредстваМеждународныйУчет.МестонахождениеОбъекта,
		|	ОсновныеСредстваМеждународныйУчет.МОЛ,
		|	ОсновныеСредстваМеждународныйУчет.Состояние,
		|	ОсновныеСредстваМеждународныйУчет.СчетУчета,
		|	ОсновныеСредстваМеждународныйУчет.СрокПолезногоИспользования,
		|	ОсновныеСредстваМеждународныйУчет.НачислятьАмортизацию,
		|	ОсновныеСредстваМеждународныйУчет.МетодНачисленияАмортизации,
		|	ОсновныеСредстваМеждународныйУчет.СчетНачисленияАмортизации,
		|	ОсновныеСредстваМеждународныйУчет.ПервоначальнаяСтоимость,
		|	ОсновныеСредстваМеждународныйУчет.СправедливаяСтоимость,
		|	ОсновныеСредстваМеждународныйУчет.ЛиквидационнаяСтоимость,
		|	ОсновныеСредстваМеждународныйУчет.СчетЗатрат,
		|	ОсновныеСредстваМеждународныйУчет.Субконто1,
		|	ОсновныеСредстваМеждународныйУчет.Субконто2,
		|	ОсновныеСредстваМеждународныйУчет.Субконто3,
		|	ОсновныеСредстваМеждународныйУчет.ПредполагаемыйОбъемПродукции,
		|	ОсновныеСредстваМеждународныйУчет.СуммаНачисленнойАмортизации,
		|	ОсновныеСредстваМеждународныйУчет.УбытокОтОбесценения,
		|	ОсновныеСредстваМеждународныйУчет.КоэффициентУскорения,
		|	ОсновныеСредстваМеждународныйУчет.СчетСниженияСтоимости
		|ПОМЕСТИТЬ ПараметрыОсновногоСредства
		|ИЗ
		|	(ВЫБРАТЬ
		|		ПериодыСреза.ОсновноеСредство КАК ОсновноеСредство,
		|		ПериодыСреза.Период КАК Период,
		|		МАКСИМУМ(ОсновныеСредстваМеждународныйУчет.Регистратор) КАК Регистратор
		|	ИЗ
		|		(ВЫБРАТЬ
		|			ОсновныеСредстваМеждународныйУчет.ОсновноеСредство КАК ОсновноеСредство,
		|			МАКСИМУМ(ОсновныеСредстваМеждународныйУчет.Период) КАК Период
		|		ИЗ
		|			РегистрСведений.ОсновныеСредстваМеждународныйУчет КАК ОсновныеСредстваМеждународныйУчет
		|		ГДЕ
		|			ОсновныеСредстваМеждународныйУчет.ОсновноеСредство = &ОсновноеСредство
		|			И ОсновныеСредстваМеждународныйУчет.Период <= &Период
		|			И ОсновныеСредстваМеждународныйУчет.Активность
		|		
		|		СГРУППИРОВАТЬ ПО
		|			ОсновныеСредстваМеждународныйУчет.ОсновноеСредство) КАК ПериодыСреза
		|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ОсновныеСредстваМеждународныйУчет КАК ОсновныеСредстваМеждународныйУчет
		|			ПО ПериодыСреза.ОсновноеСредство = ОсновныеСредстваМеждународныйУчет.ОсновноеСредство
		|				И ПериодыСреза.Период = ОсновныеСредстваМеждународныйУчет.Период
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ПериодыСреза.ОсновноеСредство,
		|		ПериодыСреза.Период) КАК ПериодыРегистраторыСреза
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ОсновныеСредстваМеждународныйУчет КАК ОсновныеСредстваМеждународныйУчет
		|		ПО ПериодыРегистраторыСреза.Период = ОсновныеСредстваМеждународныйУчет.Период
		|			И ПериодыРегистраторыСреза.Регистратор = ОсновныеСредстваМеждународныйУчет.Регистратор
		|			И ПериодыРегистраторыСреза.ОсновноеСредство = ОсновныеСредстваМеждународныйУчет.ОсновноеСредство
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ОсновноеСредство";
	
	СтруктураЗапросов.Вставить("абс_ВнеоборотныеАктивы_ТекстЗапросаОсновныеСредстваМСФОПоОдномуОС", ТекстЗапроса+";");
	
	ТекстЗапроса = 
		"ВЫБРАТЬ
		|	абс_РазукрупнениеОСМ.Ссылка,
		|	абс_РазукрупнениеОСМ.Номер,
		|	абс_РазукрупнениеОСМ.Дата,
		|	абс_РазукрупнениеОСМ.Организация,
		|	абс_РазукрупнениеОСМ.ДокументОснование,
		|	абс_РазукрупнениеОСМ.ОсновноеСредство
		|ПОМЕСТИТЬ Шапкадокумента
		|ИЗ
		|	Документ.абс_РазукрупнениеОСМ КАК абс_РазукрупнениеОСМ
		|ГДЕ
		|	абс_РазукрупнениеОСМ.Ссылка = &Ссылка";
	
	СтруктураЗапросов.Вставить("Разукрупнение_ТекстЗапросаШапкаДокумента", ТекстЗапроса+";");
	
	ТекстЗапроса = 
		"ВЫБРАТЬ
		|	абс_РазукрупнениеОСМОсновныеСредства.НомерСтроки,
		|	абс_РазукрупнениеОСМОсновныеСредства.ОсновноеСредство,
		|	абс_РазукрупнениеОСМОсновныеСредства.Коэффициент,
		|	ПараметрыОсновногоСредства.СчетУчета,
		|	ПараметрыОсновногоСредства.СчетНачисленияАмортизации,
		|	абс_РазукрупнениеОСМОсновныеСредства.СчетЗатрат,
		|	абс_РазукрупнениеОСМОсновныеСредства.Субконто1,
		|	абс_РазукрупнениеОСМОсновныеСредства.Субконто2,
		|	абс_РазукрупнениеОСМОсновныеСредства.Субконто3,
		|	абс_РазукрупнениеОСМОсновныеСредства.СчетСниженияСтоимости,
		|	абс_РазукрупнениеОСМОсновныеСредства.Местонахождение,
		|	абс_РазукрупнениеОСМОсновныеСредства.МОЛ,
		|	абс_РазукрупнениеОСМОсновныеСредства.КоэффициентУскорения,
		|	абс_РазукрупнениеОСМОсновныеСредства.НачислятьАмортизацию,
		|	ПараметрыОсновногоСредства.СрокПолезногоИспользования,
		|	ПараметрыОсновногоСредства.ДатаПринятияКУчету,
		|	абс_РазукрупнениеОСМОсновныеСредства.ОсновноеСредство.ГруппаОС КАК ГруппаОС,
		|	абс_РазукрупнениеОСМОсновныеСредства.ОсновноеСредство.ЦельИспользования КАК ЦельИспользования
		|ПОМЕСТИТЬ ТабличнаяЧастьОсновныеСредства
		|ИЗ
		|	Документ.абс_РазукрупнениеОСМ.ОсновныеСредства КАК абс_РазукрупнениеОСМОсновныеСредства,
		|	ПараметрыОсновногоСредства КАК ПараметрыОсновногоСредства
		|ГДЕ
		|	абс_РазукрупнениеОСМОсновныеСредства.Ссылка = &Ссылка";
	
	СтруктураЗапросов.Вставить("Разукрупнение_ТекстЗапросаТабличнаяЧастьОсновныеСредства", ТекстЗапроса+";");
	
	ТекстЗапроса = 
		"ВЫБРАТЬ
		|	абс_СтоимостьОСМеждународныйОстатки.ОсновноеСредство,
		|	абс_СтоимостьОСМеждународныйОстатки.СтоимостьОстаток КАК Стоимость,
		|	абс_СтоимостьОСМеждународныйОстатки.АмортизацияОстаток КАК Амортизация
		|ПОМЕСТИТЬ СтоимостьСтарогоОсновногоСредства
		|ИЗ
		|	РегистрНакопления.абс_СтоимостьОСМеждународный.Остатки(
		|			&МоментДокумента,
		|			ОсновноеСредство = &ОсновноеСредство
		|				И Организация = &Организация) КАК абс_СтоимостьОСМеждународныйОстатки";
	
	СтруктураЗапросов.Вставить("Разукрупнение_ТекстЗапросаСтоимостьСтарогоОсновногоСредства", ТекстЗапроса+";");
	
	ТекстЗапроса = 
		"ВЫБРАТЬ
		|	ТабличнаяЧастьОсновныеСредства.НомерСтроки КАК НомерСтроки,
		|	ТабличнаяЧастьОсновныеСредства.ОсновноеСредство,
		|	ВЫРАЗИТЬ(СтоимостьСтарогоОсновногоСредства.Стоимость * ТабличнаяЧастьОсновныеСредства.Коэффициент КАК ЧИСЛО(15, 2)) КАК Стоимость,
		|	ВЫРАЗИТЬ(СтоимостьСтарогоОсновногоСредства.Амортизация * ТабличнаяЧастьОсновныеСредства.Коэффициент КАК ЧИСЛО(15, 2)) КАК Амортизация
		|ПОМЕСТИТЬ РаспределениеСтоимости
		|ИЗ
		|	ТабличнаяЧастьОсновныеСредства КАК ТабличнаяЧастьОсновныеСредства,
		|	СтоимостьСтарогоОсновногоСредства КАК СтоимостьСтарогоОсновногоСредства
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	НомерСтроки";
	
	СтруктураЗапросов.Вставить("Разукрупнение_ТекстЗапросаРаспределениеСтоимости", ТекстЗапроса+";");
	
	ТекстЗапроса = 
		"ВЫБРАТЬ
		|	СтоимостьСтарогоОсновногоСредства.Стоимость - ЕСТЬNULL(ВложенныйЗапрос.Стоимость, 0) КАК Стоимость,
		|	СтоимостьСтарогоОсновногоСредства.Амортизация - ЕСТЬNULL(ВложенныйЗапрос.Амортизация, 0) КАК Амортизация
		|ПОМЕСТИТЬ НераспределеннаяСтоимость
		|ИЗ
		|	СтоимостьСтарогоОсновногоСредства КАК СтоимостьСтарогоОсновногоСредства
		|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|			СУММА(РаспределениеСтоимости.Стоимость) КАК Стоимость,
		|			СУММА(РаспределениеСтоимости.Амортизация) КАК Амортизация
		|		ИЗ
		|			РаспределениеСтоимости КАК РаспределениеСтоимости) КАК ВложенныйЗапрос
		|		ПО (ИСТИНА)";
	
	СтруктураЗапросов.Вставить("Разукрупнение_ТекстЗапросаНераспределеннаяСтоимость", ТекстЗапроса+";");
	
	ТекстЗапроса = 
		"ВЫБРАТЬ
		|	РаспределениеСтоимости.НомерСтроки КАК НомерСтроки,
		|	РаспределениеСтоимости.ОсновноеСредство,
		|	РаспределениеСтоимости.Стоимость + ЕСТЬNULL(НераспределеннаяСтоимость.Стоимость, 0) КАК Стоимость,
		|	РаспределениеСтоимости.Амортизация + ЕСТЬNULL(НераспределеннаяСтоимость.Амортизация, 0) КАК Амортизация
		|ПОМЕСТИТЬ СтоимостьНовыхОсновныхСредств
		|ИЗ
		|	РаспределениеСтоимости КАК РаспределениеСтоимости
		|		ЛЕВОЕ СОЕДИНЕНИЕ НераспределеннаяСтоимость КАК НераспределеннаяСтоимость
		|		ПО (РаспределениеСтоимости.НомерСтроки = 1)
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	НомерСтроки";
	
	СтруктураЗапросов.Вставить("Разукрупнение_ТекстЗапросаСтоимостьНовыхОсновныхСредств", ТекстЗапроса+";");
	
	ТекстЗапроса = 
		"ВЫБРАТЬ
		|	&Период,
		|	ПараметрыОсновногоСредства.ОсновноеСредство,
		|	ПараметрыОсновногоСредства.Организация,
		|	ПараметрыОсновногоСредства.ДатаПринятияКУчету,
		|	ПараметрыОсновногоСредства.МестонахождениеОбъекта,
		|	ПараметрыОсновногоСредства.МОЛ,
		|	ЗНАЧЕНИЕ(Перечисление.СостоянияОС.СнятоСУчета) КАК Состояние,
		|	ПараметрыОсновногоСредства.СчетУчета,
		|	ПараметрыОсновногоСредства.СрокПолезногоИспользования,
		|	ЛОЖЬ КАК НачислятьАмортизацию,
		|	ПараметрыОсновногоСредства.МетодНачисленияАмортизации,
		|	ПараметрыОсновногоСредства.СчетНачисленияАмортизации,
		|	ПараметрыОсновногоСредства.ПервоначальнаяСтоимость,
		|	0 КАК СправедливаяСтоимость,
		|	ПараметрыОсновногоСредства.ЛиквидационнаяСтоимость,
		|	ПараметрыОсновногоСредства.СчетЗатрат,
		|	ПараметрыОсновногоСредства.Субконто1,
		|	ПараметрыОсновногоСредства.Субконто2,
		|	ПараметрыОсновногоСредства.Субконто3,
		|	ПараметрыОсновногоСредства.ПредполагаемыйОбъемПродукции,
		|	0 КАК СуммаНачисленнойАмортизации,
		|	ПараметрыОсновногоСредства.УбытокОтОбесценения,
		|	ПараметрыОсновногоСредства.КоэффициентУскорения,
		|	ПараметрыОсновногоСредства.СчетСниженияСтоимости
		|ИЗ
		|	ПараметрыОсновногоСредства КАК ПараметрыОсновногоСредства
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	&Период,
		|	ТабличнаяЧастьОсновныеСредства.ОсновноеСредство,
		|	&Организация,
		|	ТабличнаяЧастьОсновныеСредства.ДатаПринятияКУчету,
		|	ТабличнаяЧастьОсновныеСредства.Местонахождение,
		|	ТабличнаяЧастьОсновныеСредства.МОЛ,
		|	ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ВведеноВЭксплуатацию),
		|	ТабличнаяЧастьОсновныеСредства.СчетУчета,
		|	ВЫБОР
		|		КОГДА ТабличнаяЧастьОсновныеСредства.СрокПолезногоИспользования = 0
		|			ТОГДА ПараметрыОсновногоСредства.СрокПолезногоИспользования
		|		ИНАЧЕ ТабличнаяЧастьОсновныеСредства.СрокПолезногоИспользования
		|	КОНЕЦ,
		|	ИСТИНА,
		|	ПараметрыОсновногоСредства.МетодНачисленияАмортизации,
		|	ТабличнаяЧастьОсновныеСредства.СчетНачисленияАмортизации,
		|	ВЫРАЗИТЬ(ПараметрыОсновногоСредства.ПервоначальнаяСтоимость * ТабличнаяЧастьОсновныеСредства.Коэффициент КАК ЧИСЛО(15, 2)),
		|	ВЫРАЗИТЬ(ПараметрыОсновногоСредства.СправедливаяСтоимость * ТабличнаяЧастьОсновныеСредства.Коэффициент КАК ЧИСЛО(15, 2)),
		|	ВЫРАЗИТЬ(ПараметрыОсновногоСредства.ЛиквидационнаяСтоимость * ТабличнаяЧастьОсновныеСредства.Коэффициент КАК ЧИСЛО(15, 2)),
		|	ТабличнаяЧастьОсновныеСредства.СчетЗатрат,
		|	ТабличнаяЧастьОсновныеСредства.Субконто1,
		|	ТабличнаяЧастьОсновныеСредства.Субконто2,
		|	ТабличнаяЧастьОсновныеСредства.Субконто3,
		|	ПараметрыОсновногоСредства.ПредполагаемыйОбъемПродукции,
		|	СтоимостьНовыхОсновныхСредств.Амортизация,
		|	ВЫРАЗИТЬ(ПараметрыОсновногоСредства.УбытокОтОбесценения * ТабличнаяЧастьОсновныеСредства.Коэффициент КАК ЧИСЛО(15, 2)),
		|	ВЫБОР
		|		КОГДА ТабличнаяЧастьОсновныеСредства.КоэффициентУскорения = 0
		|			ТОГДА 1
		|		ИНАЧЕ ТабличнаяЧастьОсновныеСредства.КоэффициентУскорения
		|	КОНЕЦ,
		|	ТабличнаяЧастьОсновныеСредства.СчетСниженияСтоимости
		|ИЗ
		|	ТабличнаяЧастьОсновныеСредства КАК ТабличнаяЧастьОсновныеСредства
		|		ЛЕВОЕ СОЕДИНЕНИЕ СтоимостьНовыхОсновныхСредств КАК СтоимостьНовыхОсновныхСредств
		|		ПО ТабличнаяЧастьОсновныеСредства.НомерСтроки = СтоимостьНовыхОсновныхСредств.НомерСтроки,
		|	ПараметрыОсновногоСредства КАК ПараметрыОсновногоСредства";
	
	СтруктураЗапросов.Вставить("Разукрупнение_ТекстЗапросаТаблица_ОсновныеСредстваМеждународныйУчет", ТекстЗапроса+";");
	
	ТекстЗапроса = 
		"ВЫБРАТЬ
		|	&Период КАК Период,
		|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) КАК ВидДвижения,
		|	&Организация КАК Организация,
		|	СтоимостьСтарогоОсновногоСредства.ОсновноеСредство КАК ОсновноеСредство,
		|	-СтоимостьСтарогоОсновногоСредства.Стоимость КАК Стоимость,
		|	-СтоимостьСтарогоОсновногоСредства.Амортизация КАК Амортизация
		|ИЗ
		|	СтоимостьСтарогоОсновногоСредства КАК СтоимостьСтарогоОсновногоСредства
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	&Период,
		|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход),
		|	&Организация,
		|	СтоимостьНовыхОсновныхСредств.ОсновноеСредство,
		|	СтоимостьНовыхОсновныхСредств.Стоимость,
		|	СтоимостьНовыхОсновныхСредств.Амортизация
		|ИЗ
		|	СтоимостьНовыхОсновныхСредств КАК СтоимостьНовыхОсновныхСредств";
	
	СтруктураЗапросов.Вставить("Разукрупнение_ТекстЗапросаТаблица_абс_СтоимостьОСМеждународный", ТекстЗапроса+";");
	
	ТекстЗапроса = 
		"ВЫБРАТЬ
		|	&Период,
		|	&Организация,
		|	ПараметрыОсновногоСредства.СчетУчета КАК СчетДт,
		|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоМеждународные.ОсновныеСредства) КАК ВидСубконтоДт1,
		|	СтоимостьСтарогоОсновногоСредства.ОсновноеСредство КАК СубконтоДт1,
		|	ЗНАЧЕНИЕ(ПланСчетов.Международный.Служебный) КАК СчетКт,
		|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоМеждународные.ПустаяСсылка) КАК ВидСубконтоКт1,
		|	НЕОПРЕДЕЛЕНО КАК СубконтоКт1,
		|	-СтоимостьСтарогоОсновногоСредства.Стоимость КАК Сумма,
		|	""Разукрупнение ОС"" КАК Содержание,
		|	Шапкадокумента.ДокументОснование КАК ПервичныйДокумент
		|ИЗ
		|	СтоимостьСтарогоОсновногоСредства КАК СтоимостьСтарогоОсновногоСредства,
		|	ПараметрыОсновногоСредства КАК ПараметрыОсновногоСредства,
		|	Шапкадокумента КАК Шапкадокумента
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	&Период,
		|	&Организация,
		|	ЗНАЧЕНИЕ(ПланСчетов.Международный.Служебный),
		|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоМеждународные.ПустаяСсылка),
		|	НЕОПРЕДЕЛЕНО,
		|	ПараметрыОсновногоСредства.СчетНачисленияАмортизации,
		|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоМеждународные.ОсновныеСредства),
		|	СтоимостьСтарогоОсновногоСредства.ОсновноеСредство,
		|	-СтоимостьСтарогоОсновногоСредства.Амортизация,
		|	""Разукрупнение ОС"",
		|	Шапкадокумента.ДокументОснование
		|ИЗ
		|	ПараметрыОсновногоСредства КАК ПараметрыОсновногоСредства,
		|	Шапкадокумента КАК Шапкадокумента,
		|	СтоимостьСтарогоОсновногоСредства КАК СтоимостьСтарогоОсновногоСредства
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	&Период,
		|	&Организация,
		|	ТабличнаяЧастьОсновныеСредства.СчетУчета,
		|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоМеждународные.ОсновныеСредства),
		|	ТабличнаяЧастьОсновныеСредства.ОсновноеСредство,
		|	ЗНАЧЕНИЕ(ПланСчетов.Международный.Служебный),
		|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоМеждународные.ПустаяСсылка),
		|	НЕОПРЕДЕЛЕНО,
		|	СтоимостьНовыхОсновныхСредств.Стоимость,
		|	""Разукрупнение ОС"",
		|	Шапкадокумента.ДокументОснование
		|ИЗ
		|	ТабличнаяЧастьОсновныеСредства КАК ТабличнаяЧастьОсновныеСредства
		|		ЛЕВОЕ СОЕДИНЕНИЕ СтоимостьНовыхОсновныхСредств КАК СтоимостьНовыхОсновныхСредств
		|		ПО ТабличнаяЧастьОсновныеСредства.НомерСтроки = СтоимостьНовыхОсновныхСредств.НомерСтроки,
		|	Шапкадокумента КАК Шапкадокумента
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	&Период,
		|	&Организация,
		|	ЗНАЧЕНИЕ(ПланСчетов.Международный.Служебный),
		|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоМеждународные.ПустаяСсылка),
		|	НЕОПРЕДЕЛЕНО,
		|	ТабличнаяЧастьОсновныеСредства.СчетНачисленияАмортизации,
		|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоМеждународные.ОсновныеСредства),
		|	СтоимостьНовыхОсновныхСредств.ОсновноеСредство,
		|	СтоимостьНовыхОсновныхСредств.Амортизация,
		|	""Разукрупнение ОС"",
		|	Шапкадокумента.ДокументОснование
		|ИЗ
		|	ТабличнаяЧастьОсновныеСредства КАК ТабличнаяЧастьОсновныеСредства
		|		ЛЕВОЕ СОЕДИНЕНИЕ СтоимостьНовыхОсновныхСредств КАК СтоимостьНовыхОсновныхСредств
		|		ПО ТабличнаяЧастьОсновныеСредства.НомерСтроки = СтоимостьНовыхОсновныхСредств.НомерСтроки,
		|	Шапкадокумента КАК Шапкадокумента";
	
	СтруктураЗапросов.Вставить("Разукрупнение_ТекстЗапросаТаблица_Международный", ТекстЗапроса+";");
	
	ТекстЗапроса = 
		"УНИЧТОЖИТЬ ПараметрыОсновногоСредства
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ Шапкадокумента
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ ТабличнаяЧастьОсновныеСредства
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ СтоимостьСтарогоОсновногоСредства
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ РаспределениеСтоимости
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ НераспределеннаяСтоимость
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ СтоимостьНовыхОсновныхСредств";
	
	СтруктураЗапросов.Вставить("Разукрупнение_УдалениеВременныхТаблиц", ТекстЗапроса+";");
	
КонецПроцедуры

Процедура ДобавитьОбщиеЗапросы(СтруктураЗапросов)

	ТекстЗапроса = 
		"ВЫБРАТЬ
		|	Международный.Ссылка КАК Счет,
		|	ЕСТЬNULL(ВидыСубконто1.ВидСубконто, ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоМеждународные.ПустаяСсылка)) КАК ВидСубконто1,
		|	ЕСТЬNULL(ВидыСубконто2.ВидСубконто, ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоМеждународные.ПустаяСсылка)) КАК ВидСубконто2,
		|	ЕСТЬNULL(ВидыСубконто3.ВидСубконто, ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоМеждународные.ПустаяСсылка)) КАК ВидСубконто3
		|ПОМЕСТИТЬ ВидыСубконтоСчетов
		|ИЗ
		|	ПланСчетов.Международный КАК Международный
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Международный.ВидыСубконто КАК ВидыСубконто1
		|		ПО Международный.Ссылка = ВидыСубконто1.Ссылка
		|			И (ВидыСубконто1.НомерСтроки = 1)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Международный.ВидыСубконто КАК ВидыСубконто2
		|		ПО Международный.Ссылка = ВидыСубконто2.Ссылка
		|			И (ВидыСубконто2.НомерСтроки = 2)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Международный.ВидыСубконто КАК ВидыСубконто3
		|		ПО Международный.Ссылка = ВидыСубконто3.Ссылка
		|			И (ВидыСубконто3.НомерСтроки = 3)
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Счет";
		
	СтруктураЗапросов.Вставить("абс_МеждународныйУчет_ТекстЗапросаВидыСубконтоСчетов", ТекстЗапроса+";");
	
	ТекстЗапроса = 
		"ВЫБРАТЬ
		|	СоответствиеСчетовБУиМСФОСрезПоследних.СчетХозрасчетный КАК СчетХозрасчетный,
		|	СоответствиеСчетовБУиМСФОСрезПоследних.ВидДвижения КАК ВидДвижения,
		|	СоответствиеСчетовБУиМСФОСрезПоследних.СчетМеждународный
		|ПОМЕСТИТЬ СоответствиеСчетовХозрасчетныйМСФО
		|ИЗ
		|	РегистрСведений.СоответствиеСчетовБУиМСФО.СрезПоследних(
		|			&Период,
		|			СубконтоХозр1 В (&ПустыеСубконто)
		|				И СубконтоХозр2 В (&ПустыеСубконто)
		|				И СубконтоХозр3 В (&ПустыеСубконто)) КАК СоответствиеСчетовБУиМСФОСрезПоследних
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	СчетХозрасчетный,
		|	ВидДвижения";
		
	СтруктураЗапросов.Вставить("абс_МеждународныйУчет_ТекстЗапросаСоответствиеСчетовХозрасчетный", ТекстЗапроса+";");
	
	ТекстЗапроса = 
		"ВЫБРАТЬ
		|	ВЫРАЗИТЬ(ТаблицаСроков.ГруппаОС КАК Перечисление.ГруппыОС) КАК ГруппаОС,
		|	ВЫРАЗИТЬ(ТаблицаСроков.ЦельИспользования КАК Справочник.ЦелиИспользования) КАК ЦельИспользования,
		|	ВЫРАЗИТЬ(ТаблицаСроков.СрокИспользования КАК ЧИСЛО(4, 0)) КАК СрокИспользования
		|ПОМЕСТИТЬ СрокиПолезногоИспользования
		|ИЗ
		|	&ТаблицаСроков КАК ТаблицаСроков
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ГруппаОС,
		|	ЦельИспользования";
		
	СтруктураЗапросов.Вставить("абс_МеждународныйУчет_ТекстЗапросаСрокиПолезногоИспользования", ТекстЗапроса+";");

КонецПроцедуры










/////////////////////////////////////////////////////////////////////////////////
// Программный интерфейс проведения документов

Процедура ИнициализироватьДанныеДокумента(Ссылка, ДополнительныеСвойства, Отказ) Экспорт
	
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = ДополнительныеСвойства.ДляПроведения.СтруктураВременныеТаблицы.МенеджерВременныхТаблиц;
	Запрос.УстановитьПараметр("Ссылка", Ссылка);
	Запрос.УстановитьПараметр("Период", Ссылка.Дата);
	Запрос.УстановитьПараметр("Организация", Ссылка.Организация);
	Запрос.УстановитьПараметр("МоментДокумента", Новый Граница(Ссылка.МоментВремени(), ВидГраницы.Исключая));
	
	ТекстыЗапросов = Новый СписокЗначений;
	//ТекстыЗапросов.Добавить(ТекстЗапросаШапкаДокумента(), "");
	//ТекстыЗапросов.Добавить(ТекстЗапросаОсновныеСредстваДокумента(), "");
	//ТекстыЗапросов.Добавить(абс_ВнеоборотныеАктивы.ТекстЗапроса_ОсновныеСредстваРЖДПоТаблицеОС("ОсновныеСредстваДокумента"), "");
	//ТекстыЗапросов.Добавить(ТекстЗапросаОстаткиСтоимостиОС(), "");
	//ТекстыЗапросов.Добавить(ТекстЗапросаСтоимостьКомплектации(), "");
	//
	//ТекстыЗапросов.Добавить(ТекстЗапросаТаблица_абс_ОсновныеСредстваРЖД(), "Таблица_абс_ОсновныеСредстваРЖД");
	//ТекстыЗапросов.Добавить(ТекстЗапросаТаблица_абс_СтоимостьОСРЖД(), "Таблица_абс_СтоимостьОСРЖД");
	//ТекстыЗапросов.Добавить(ТекстЗапросаТаблица_абс_МеждународныйОСРЖД(), "Таблица_абс_МеждународныйОСРЖД");
	
	абс_ПроведениеДокументов.ИницализироватьТаблицыДляДвижений(Запрос, ТекстыЗапросов, ДополнительныеСвойства.ТаблицыДляДвижений);
	
КонецПроцедуры


/////////////////////////////////////////////////////////////////////////////////
// Функции, возвращающие тексты запросов для инициализации данных документа

Функция ТекстЗапросаШапкаДокумента()
	
	Возврат "";
	
КонецФункции

Функция ТекстЗапросаТаблицаОС()
	
	Возврат "";
	
КонецФункции

Функция ТекстЗапросаТаблица_абс_ОсновныеСредстваРЖД()
	
	Возврат "";
	
КонецФункции

Функция ТекстЗапросаТаблица_абс_СтоимостьОСРЖД()
	
	Возврат "";
	
КонецФункции

Функция ТекстЗапросаТаблица_абс_МеждународныйОСРЖД()
	
	Возврат "";
	
КонецФункции

