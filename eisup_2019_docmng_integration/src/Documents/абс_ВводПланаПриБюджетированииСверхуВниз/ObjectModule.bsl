Перем СписокКолонок Экспорт;

Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)
	// Вставить содержимое обработчика.
	СписокРедактируемыхАналитик = Новый ХранилищеЗначения(СписокКолонок);
	Если Модифицированность() Тогда
		Если Год <> Константы.абс_РазрешенныйДляРедактированияГодБюджета.Получить() Тогда
			сообщить("Бюджет "+Год+" года закрыт для редактирования");
			Отказ = Истина;
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры

Процедура ОбработкаПроведения(Отказ, РежимПроведения)
	//{{__КОНСТРУКТОР_ДВИЖЕНИЙ_РЕГИСТРОВ
	// Данный фрагмент построен конструктором.
	// При повторном использовании конструктора, внесенные вручную изменения будут утеряны!!!

	// регистр ОборотыБюджетов 
	Движения.ОборотыБюджетов.Записывать = Истина;
	Движения.ОборотыБюджетов.Очистить();
	
	// регистр УстановкаОграниченийПоБюджетам
	Движения.абс_УстановкаЛимитовПоСтатьям.Записывать = Истина;
	Движения.абс_УстановкаЛимитовПоСтатьям.Очистить();

	// регистр КонтролируемыеЗначенияБюджетов 
	Движения.КонтролируемыеЗначенияБюджетов.Записывать = Истина;
	Движения.КонтролируемыеЗначенияБюджетов.Очистить();

	
	Для Каждого ТекСтрокаБюджет Из Бюджет Цикл
		Движение = Движения.ОборотыБюджетов.Добавить();
		Движение.Период = ТекСтрокаБюджет.Период;
		Движение.Сценарий = Сценарий;
		Движение.ЦФО = ТекСтрокаБюджет.ЦФО;
		Движение.СтатьяОборотов = ТекСтрокаБюджет.БюджетнаяСтатья;
		Движение.Валюта = ТекСтрокаБюджет.Валюта;
		Движение.абс_ТипКонтрагента = ТекСтрокаБюджет.ТипКонтрагента;
		Движение.абс_ТипСети = ТекСтрокаБюджет.ТипСети;
		Движение.абс_КВ = ТекСтрокаБюджет.КВ;
		Движение.абс_ТЭО = ТекСтрокаБюджет.ТЭО;
		Движение.абс_ЦФУ = ТекСтрокаБюджет.ЦФУ;
		Движение.абс_ТипРасхода = ТекСтрокаБюджет.ТипРасходаНаПроизводствоИРеализацию;
		Движение.Количество = ТекСтрокаБюджет.Количество;
		Движение.СуммаУпр = ТекСтрокаБюджет.СуммаРуб;
		Движение.ВалютнаяСумма = ТекСтрокаБюджет.СуммаВал;
		Движение.СуммаСценария = ТекСтрокаБюджет.СуммаРуб;
		Движение.Организация = ТекСтрокаБюджет.Организация;
		
		Движение = Движения.абс_УстановкаЛимитовПоСтатьям.Добавить();
		Движение.Период = ТекСтрокаБюджет.Период;
		Движение.Сценарий = Сценарий;
		Движение.СтатьяОборотов = ТекСтрокаБюджет.БюджетнаяСтатья;
		Движение.ЦФО = ТекСтрокаБюджет.ЦФО;
		Движение.абс_ТипКонтрагента = ТекСтрокаБюджет.ТипКонтрагента;
		Движение.абс_ТипСети = ТекСтрокаБюджет.ТипСети;
		Движение.абс_КВ = ТекСтрокаБюджет.КВ;
		Движение.абс_ТЭО = ТекСтрокаБюджет.ТЭО;
		Движение.абс_ЦФУ = ТекСтрокаБюджет.ЦФУ;
		Движение.абс_ТипРасхода = ТекСтрокаБюджет.ТипРасходаНаПроизводствоИРеализацию;
		Движение.Организация = ТекСтрокаБюджет.Организация;
		
		Движение = Движения.КонтролируемыеЗначенияБюджетов.Добавить();
		Движение.Период = ТекСтрокаБюджет.Период;
		Движение.Сценарий = Сценарий;
		Движение.СтатьяОборотов = ТекСтрокаБюджет.БюджетнаяСтатья;
		Движение.ЦФО = ТекСтрокаБюджет.ЦФО;
		Движение.Организация = ТекСтрокаБюджет.Организация;
		Движение.абс_ТипКонтрагента = ТекСтрокаБюджет.ТипКонтрагента;
		Движение.абс_ТипСети = ТекСтрокаБюджет.ТипСети;
		Движение.абс_КВ = ТекСтрокаБюджет.КВ;
		Движение.абс_ТЭО = ТекСтрокаБюджет.ТЭО;
		Движение.абс_ЦФУ = ТекСтрокаБюджет.ЦФУ;
		Движение.абс_ТипРасхода = ТекСтрокаБюджет.ТипРасходаНаПроизводствоИРеализацию;
		Движение.СуммаСценарияКонтроль = ТекСтрокаБюджет.СуммаЛимитаРуб;
		Движение.СуммаСценарияКонтрольВал = ТекСтрокаБюджет.СуммаЛимитаВал;
		Движение.Валюта = ТекСтрокаБюджет.Валюта;
	//	Движение.СуммаСценарияИсполнение = ТекСтрокаБюджет.СуммаРуб;
	КонецЦикла;

	//}}__КОНСТРУКТОР_ДВИЖЕНИЙ_РЕГИСТРОВ
КонецПроцедуры
