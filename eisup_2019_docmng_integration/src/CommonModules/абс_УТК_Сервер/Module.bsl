// ЭКСПОРТНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ МОДУЛЯ ----------------------------------------------

// Функция инициализирует проверку наличия ключа
//
// Параметры:
//			Нет
// Возвращаемое значение:
//			Булево
//
Функция ПроверитьНаличиеКлюча() Экспорт
	
	Флаг = Истина;
	Флаг = Не Флаг И Не Флаг Или Флаг;
	Возврат Флаг;
	
КонецФункции

// Получаем из полного номера версии конфигурации номер релиза без номера сборки.
//
// Параметры
//  НомерВерсии  – Строка – полный номер версии
//
// Возвращаемое значение:
//  Строка – номер релиза УТК
//
Функция ПолучитьНомерРелизаУТК(НомерВерсии) Экспорт
	
	КоличествоТочек = 0;
	ПервыйСимволРелиза = 0;
	
	Для х = 1 По СтрДлина(НомерВерсии) Цикл
	
		Если Сред(НомерВерсии, х, 1) = "." Тогда
			КоличествоТочек = КоличествоТочек + 1;
		КонецЕсли;
		
		Если КоличествоТочек = 4 Тогда
			ПервыйСимволРелиза = х + 1;
			Прервать;
		КонецЕсли;
	
	КонецЦикла;
	Если ПервыйСимволРелиза =0 Тогда
		Возврат ""
	Иначе
		Возврат Сред(НомерВерсии, ПервыйСимволРелиза, 3);
	КонецЕсли;
КонецФункции // ПолучитьНомерРелизаУТК()

// ФУНКЦИЯ ДЛЯ ЗАЩИТЫ МОДУЛЯ -----------------------------------------------

// Функция возвращает строку, наименование макета Компоненты защиты
//
// Параметры:
//			Нет
//
Функция GetUSBKeyComponentLocation()
	Перем Постфикс;
	СистемнаяИнформация = Новый СистемнаяИнформация;
	
	Если СистемнаяИнформация.ТипПлатформы = ТипПлатформы.Windows_x86 тогда
		Постфикс = "Win32";
	ИначеЕсли СистемнаяИнформация.ТипПлатформы = ТипПлатформы.Windows_x86_64 тогда
		Постфикс = "Win64";
	КонецЕсли;
	
	
	Макет = Метаданные.ОбщиеМакеты.Найти("КомпонентаЗащиты_Hasp_" + Постфикс);
	Если Макет = Неопределено тогда
		ВызватьИсключение("Макет с образом компоненты защиты не найден");
	КонецЕсли;

	Возврат Макет.ПолноеИмя();
КонецФункции



