

Процедура ВыполнитьСписаниеПоЗаявке(Движения, СтруктураШапкиДокумента, ТаблицаПоТоварам) Экспорт
	
	Если НЕ ЗначениеЗаполнено(СтруктураШапкиДокумента.абс_ЗаявкаНаТМЦ) Тогда 
		Возврат;
	КонецЕсли;
	
	Для каждого строка из ТаблицаПоТоварам Цикл
		
		Движение 					= Движения.абс_ЗаявкиНаОбеспечение.ДобавитьРасход();
		Движение.Период             = СтруктураШапкиДокумента.Дата;
		Движение.Номенклатура 		= строка.Номенклатура;
		Движение.Склад 				= СтруктураШапкиДокумента.Склад;
		Движение.СерияНоменклатуры 	= строка.СерияНоменклатуры;
		Движение.ХарактеристикаНоменклатуры 	= строка.ХарактеристикаНоменклатуры;
		Движение.Заказ 				= СтруктураШапкиДокумента.абс_ЗаявкаНаТМЦ;
		Движение.Организация 		= СтруктураШапкиДокумента.Организация;
		
		//Если ТипЗнч(СтруктураШапкиДокумента.Ссылка) = Тип("ДокументСсылка.ТребованиеНакладная") Тогда 
			Движение.Проект 		= строка.Проект;
		//Иначе
		//	Движение.Проект 		= строка.абс_Проект;	
		//КонецЕсли;
		
		Движение.Количество  		= строка.Количество;
		Движение.СписаниеПартий 	= Истина;	
					
	КонецЦикла;

	Движения.абс_ЗаявкиНаОбеспечение.Записать();
	
КонецПроцедуры
