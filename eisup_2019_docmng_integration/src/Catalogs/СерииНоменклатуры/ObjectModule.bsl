////////////////////////////////////////////////////////////////////////////////
// ЭКСПОРТИРУЕМЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ

// Функция устанавливает новое наименование серии по значениям реквизитов.
//
// Параметры:
//  Нет.
//
// Возвращаемое значение:
//  Строка - сформированное наименование.
//
Функция СформироватьНаименование() Экспорт

	Строка = "";

	Если ЗначениеЗаполнено(СерийныйНомер) Тогда
		Строка = Строка + СерийныйНомер;
	КонецЕсли;

	//АБС Тупиков начало 23042012
	
	Если ПараметрыСеанса.абс_ПользовательДЗО Тогда

		Если ЗначениеЗаполнено(СрокГодности) Тогда
			Строка = Строка + Формат(СрокГодности,"ДФ=""дд.ММ.гггг""") + ", ";
		КонецЕсли;

		Если ЗначениеЗаполнено(НомерГТД) Тогда
			Строка = Строка + СокрЛП(НомерГТД.Код) + ", ";
		КонецЕсли;

		Если ЗначениеЗаполнено(СтранаПроисхождения) Тогда
			Строка = Строка + СтранаПроисхождения.Наименование + ", ";
		КонецЕсли;

		Строка = Лев(Строка, СтрДлина(Строка) - 2);
		
	КонецЕсли;
	
	//\\АБС Тупиков конец

	Если ПустаяСтрока(Строка) Тогда
		Строка = "<Свойства не назначены>";
	КонецЕсли;

	Возврат Строка;

КонецФункции

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ

Процедура ПриКопировании(ОбъектКопирования)
	
	Если Не ЭтоГруппа Тогда
		
		ОсновноеИзображение = Неопределено;
		
	КонецЕсли;
	
КонецПроцедуры
// Процедура вызывается перед записью элемента справочника.
//
Процедура ПередЗаписью(Отказ)

	Если ОбменДанными.Загрузка Тогда
		Возврат;
	КонецЕсли;	
	
	Если ЭтоНовый() Тогда
		ЭтотОбъект.Наименование  = СтрЗаменить(ЭтотОбъект.Наименование,Символы.НПП," "); 
	КонецЕсли;	
	
	// Проверим можно ли изменять реквизиты договора.
	// Проверка осуществляется только если записывается уже существующий договор
	Если НЕ ЭтоНовый() Тогда

		// Проверим возможность смены способа ведения взаиморасчетов и валюты взаиморасчетов
		Если НомерГТД <> Ссылка.НомерГТД
		 ИЛИ СтранаПроисхождения <> Ссылка.СтранаПроисхождения Тогда

			Если ПолныеПрава.СерииНоменклатуры_СуществуютСсылки(Ссылка) Тогда

				Сообщить("Существуют документы, проведенные по серии """ + Наименование + """.
						 |Реквизиты ""Номер ГТД"" и ""Страна происхождения"" не могут быть изменены, элемент не записан.", 
						 СтатусСообщения.Важное);
				Отказ = Истина;

			КонецЕсли;

		КонецЕсли;

	КонецЕсли;

КонецПроцедуры // ПередЗаписью()

